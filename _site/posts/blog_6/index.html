<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jayani P.G. Lakshika">
<meta name="dcterms.date" content="2023-03-06">

<title>PhD research project - Is neighborhood parameter really matter in non-linear dimensionality reduction (NLDR) techniques?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="../../site_libs/langevitour-0.5.1/langevitour-pack.js"></script>
<script src="../../site_libs/langevitour-binding-0.5.1/langevitour.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">PhD research project</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Blogs.html">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Learning.html">
 <span class="menu-text">Explore</span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-default-value-is-always-not-good." id="toc-the-default-value-is-always-not-good." class="nav-link active" data-scroll-target="#the-default-value-is-always-not-good.">The default value is always not good.</a></li>
  <li><a href="#is-it-possible-to-find-an-effective-value-for-the-neighborhood-parameter" id="toc-is-it-possible-to-find-an-effective-value-for-the-neighborhood-parameter" class="nav-link" data-scroll-target="#is-it-possible-to-find-an-effective-value-for-the-neighborhood-parameter">Is it possible to find an effective value for the neighborhood parameter?</a>
  <ul class="collapse">
  <li><a href="#effective-value-for-perplexity-neighborhood-parameter-of-t-sne" id="toc-effective-value-for-perplexity-neighborhood-parameter-of-t-sne" class="nav-link" data-scroll-target="#effective-value-for-perplexity-neighborhood-parameter-of-t-sne">Effective value for perplexity (neighborhood parameter of t-SNE)</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Is neighborhood parameter really matter in non-linear dimensionality reduction (NLDR) techniques?</h1>
  <div class="quarto-categories">
    <div class="quarto-category">NLDR</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jayani P.G. Lakshika </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 6, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>In this blog post, I will explore neighborhood parameters of t-SNE, UMAP, PHATE, PaCMAP, and TriMAP and compare the results with some simulated data sets.</p>
<p>First of all, let’s identify what is meant by a neighborhood parameter of an NLDR technique. <span class="math inline">\(\color{red}{\text{The neighborhood parameter represents the number of close neighbors each point has}}\)</span>. In each NLDR technique, different naming is used as a function parameter. The following table shows more details.</p>
<table class="table">
<caption><strong>Table1: Neighborhood parameter of t-SNE, UMAP, PHATE, PaCMAP, and TriMAP</strong></caption>
<colgroup>
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 39%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">NLDR technique</th>
<th style="text-align: left;">Neighborhood parameter</th>
<th style="text-align: left;">Explanation as in function definition</th>
<th style="text-align: left;">Calculation or default value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">t-SNE</td>
<td style="text-align: left;"><code>perplexity</code></td>
<td style="text-align: left;">This value effectively controls how many nearest neighbours are taken into account when constructing the embedding in the low-dimensional space.</td>
<td style="text-align: left;">Default is 30 and should not be bigger than <code>3 * perplexity &lt; nrow(X) - 1</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">UMAP</td>
<td style="text-align: left;"><code>n_neighbors</code></td>
<td style="text-align: left;">The number of approximate nearest neighbors used to construct the initial high-dimensional graph.</td>
<td style="text-align: left;">Default: 15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PHATE</td>
<td style="text-align: left;"><code>knn</code></td>
<td style="text-align: left;">Number of nearest neighbors on which to build kernel.</td>
<td style="text-align: left;">Default: 5</td>
</tr>
<tr class="even">
<td style="text-align: left;">PaCMAP</td>
<td style="text-align: left;"><code>n_neighbors</code></td>
<td style="text-align: left;">The number of neighbors considered in the k-Nearest Neighbor graph.</td>
<td style="text-align: left;">Default to 10 for data set whose sample size is smaller than 10000. For large data set whose sample size (n) is larger than 10000, the default value is: <code>10 + 15 * (log10(n) - 4)</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TriMAP</td>
<td style="text-align: left;"><code>n_inliers</code></td>
<td style="text-align: left;">Number of nearest neighbors for forming the nearest neighbor triplets.</td>
<td style="text-align: left;">Default: 12</td>
</tr>
</tbody>
</table>
<section id="the-default-value-is-always-not-good." class="level2">
<h2 class="anchored" data-anchor-id="the-default-value-is-always-not-good.">The default value is always not good.</h2>
<p>Let’s start with a simple example. To make things as simple as possible, I’ll consider two clusters in a 2D plane, as shown in <a href="#fig-fig1">Figure&nbsp;1</a>.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202303001</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x1=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">x2=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"Class 1"</span>,<span class="dv">100</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x1=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">x2=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="fl">0.05</span>))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"Class 2"</span>,<span class="dv">100</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>df_2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df1, df2)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>df_2_with_label <span class="ot">&lt;-</span> df_2 <span class="sc">%&gt;%</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> x2, <span class="at">color =</span> df_2<span class="sc">$</span>class))<span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#1f78b4"</span>, <span class="st">"#e31a1c"</span>)) <span class="sc">+</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Class"</span>)) <span class="sc">+</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>df_2_with_label</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig1-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Original data of two clusters in a 2D plane.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>First, compare the results of t-SNE, UMAP, PHATE, PaCMAP, and TriMAP with the default value of the neighborhood parameter. <a href="#fig-fig2">Figure&nbsp;2</a> shows the 2D embedding visualization of considered NLDR techniques.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data_pca <span class="ot">&lt;-</span> df_2 <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ## tSNE</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># data_pca &lt;- df_2 %&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(where(is.numeric))</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># random_num2 &lt;- runif(1, min = 1, max = 10000000)</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(random_num2)</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># tSNE_fit &lt;- data_pca %&gt;%</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   Rtsne(perplexity = 30)</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># tSNE_df &lt;- tSNE_fit$Y %&gt;%</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   as.data.frame() </span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># names(tSNE_df) &lt;- c('embedding_1', 'embedding_2')</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># tSNE_df$type &lt;- rep("tSNE", nrow(data_pca))</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># ## UMAP</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># random_num2 &lt;- runif(1, min = 1, max = 10000000)</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(random_num2)</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co"># UMAP_fit &lt;- data_pca %&gt;%</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   umap(n_neighbors = 15)</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co"># UMAP_df &lt;- UMAP_fit$layout %&gt;%</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   as.data.frame()  </span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co"># names(UMAP_df) &lt;- c('embedding_1', 'embedding_2')</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co"># UMAP_df$type &lt;- rep("UMAP", nrow(data_pca))</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Phate</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co"># random_num2 &lt;- runif(1, min = 1, max = 10000000)</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(random_num2)</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co"># tree_phate_fit &lt;- phate(data_pca, 5)</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="co"># PHATE_df &lt;- as.data.frame(tree_phate_fit$embedding) </span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="co"># PHATE_df &lt;- PHATE_df %&gt;% select("PHATE1", "PHATE2")</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="co"># names(PHATE_df) &lt;- c('embedding_1', 'embedding_2')</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="co"># PHATE_df$type &lt;- rep("PHATE", nrow(data_pca))</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="co"># ## TriMAP</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="co"># source("functions_tri_hex_TriMAP_without_pc.R", local = TRUE)</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co"># source_python("Fit_TriMAP_code.py")</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="co"># n_inliers_n &lt;- as.integer(12)</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="co"># n_outliers_n &lt;- as.integer(4)</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="co"># n_random_n &lt;- as.integer(3)</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="co"># tem_dir &lt;- tempdir()</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit_TriMAP_data(data_pca, tem_dir)</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a><span class="co"># path &lt;- file.path(tem_dir, "df_2_without_class.csv")</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a><span class="co"># path2 &lt;- file.path(tem_dir, "dataset_3_TriMAP_values.csv")</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="co"># random_num2 &lt;- runif(1, min = 1, max = 10000000)</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(random_num2)</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit_TriMAP(as.integer(2), n_inliers_n, n_outliers_n, n_random_n, path, path2)</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a><span class="co"># df_TriMAP &lt;- read.csv(path2)</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a><span class="co"># names(df_TriMAP) &lt;- c('embedding_1', 'embedding_2')</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a><span class="co"># df_TriMAP$type &lt;- rep("TriMAP", nrow(data_pca))</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a><span class="co">#     </span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a><span class="co"># ## PaCMAP</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a><span class="co"># source("functions_tri_hex_PaCMAP_without_pc.R", local = TRUE)</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a><span class="co"># source_python("Fit_PacMAP_code.py")</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a><span class="co"># knn_n &lt;- as.integer(10)</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a><span class="co"># init_n &lt;- "random"</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a><span class="co"># MN_ratio_n &lt;- 0.5</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a><span class="co"># FP_ratio_n &lt;- 2.0</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a><span class="co"># tem_dir &lt;- tempdir()</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit_PacMAP_data(data_pca, tem_dir)</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a><span class="co"># random_num2 &lt;- runif(1, min = 1, max = 10000000)</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(random_num2)</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a><span class="co"># path &lt;- file.path(tem_dir, "df_2_without_class.csv")</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a><span class="co"># path2 &lt;- file.path(tem_dir, "dataset_3_PaCMAP_values.csv")</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit_PaCMAP(as.integer(2), knn_n, init_n, MN_ratio_n, FP_ratio_n, path, path2)</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a><span class="co"># df_PaCMAP &lt;- read.csv(path2)</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a><span class="co"># names(df_PaCMAP) &lt;- c('embedding_1', 'embedding_2')</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a><span class="co"># df_PaCMAP$type &lt;- rep("PaCMAP", nrow(data_pca))</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a><span class="co"># expample_1 &lt;- bind_rows(tSNE_df, UMAP_df, PHATE_df, df_TriMAP, df_PaCMAP)</span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a><span class="co"># expample_1</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(expample_1, "Example_1.csv")</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>example_1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Example_1.csv"</span>)</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>expample_1_with_label <span class="ot">&lt;-</span> example_1 <span class="sc">%&gt;%</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> embedding_2, <span class="at">color =</span> <span class="fu">rep</span>(df_2<span class="sc">$</span>class, <span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#1f78b4"</span>, <span class="st">"#e31a1c"</span>)) <span class="sc">+</span></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Class"</span>)) <span class="sc">+</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>type, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>)</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>expample_1_with_label</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig2-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: 2D embedding by t-SNE, UMAP, PHATE, PaCMAP, and TriMAP</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>According to <a href="#fig-fig2">Figure&nbsp;2</a>, the 2D embedding plots show the two clusters, although with very different shapes. With PHATE, TriMAP, and UMAP, the local structure dominates. Also, clumps (random noise) exist within each cluster in t-SNE and PaCMAP.</p>
<p>Let’s consider more complex examples. First, I’ll evaluate five Gaussian clusters in 4D, as shown in <a href="#fig-fig3">Figure&nbsp;3</a>. Distances between clusters and cluster size are the same in this example.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202303002</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">y=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">z=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">w=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"Class 1"</span>,<span class="dv">100</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">y=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">z=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">w=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"Class 2"</span>,<span class="dv">100</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">y=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">z=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">w=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>))</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>df3<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"Class 3"</span>,<span class="dv">100</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">y=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">z=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">w=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>))</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>df4<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"Class 4"</span>,<span class="dv">100</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>df5 <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">y=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">z=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.05</span>), <span class="at">w=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="fl">0.05</span>))</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>df5<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"Class 5"</span>,<span class="dv">100</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>df_2_n <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df1, df2, df3, df4, df5)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>df_2_n <span class="ot">&lt;-</span> df_2_n <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">x1 =</span> x, <span class="at">x2 =</span> y, <span class="at">x3 =</span> z, <span class="at">x4 =</span> w)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>data_pca_n <span class="ot">&lt;-</span> df_2_n <span class="sc">%&gt;%</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="fu">langevitour</span>(data_pca_n, <span class="at">group =</span> df_2_n<span class="sc">$</span>class, <span class="at">levelColors =</span> <span class="fu">c</span>(<span class="st">"#1f78b4"</span>, <span class="st">"#e31a1c"</span>, <span class="st">"#33a02c"</span>, <span class="st">"#ff7f00"</span>, <span class="st">"#6a3d9a"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-fig3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div class="langevitour html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-3c803e7d9c22aaa11002" style="width:700px;height:600px;"></div>
<script type="application/json" data-for="htmlwidget-3c803e7d9c22aaa11002">{"x":{"X":[[-0.063428900382515,-0.0290967658846792,0.00431087453885706,0.023377129826447],[-0.0771144914580479,-0.0256554392133283,0.0393011591344982,-0.0518131602106757],[0.0233249123753606,-0.0501405473223158,-0.0375021572546835,0.0176295623801742],[0.017657535225073,0.0595168522559822,0.0309034894521253,-0.00070515896134758],[-0.0440370949169986,-0.00490809905301605,0.0221708622946518,0.000508599209783114],[0.0499382660697718,0.0544789951947241,0.0264869838746036,0.0666283204169027],[0.0924395521387048,0.0016232007450883,0.0380209348184209,-0.024722551261737],[0.0590620756428379,0.0343453331897356,-0.109524249407457,0.028596913442721],[-0.0431078679136126,0.0268482819711521,-0.00376039580752442,0.0159856274190606],[0.0622079433085881,-0.0668964276005401,-0.0484350380285287,-0.0526132764888252],[-0.0445867409860919,-0.048429491219857,-0.0292088151583931,-0.0523677994046196],[-0.0480822552054961,-0.0761522987738439,-0.0221324242979277,-0.0380471643563669],[-0.00029574646755416,-0.118859327236811,-0.0499589522166127,-0.0185700172092303],[-0.0692901668965198,-0.0704376823863019,-0.00232255264430416,0.048228322074984],[-0.00110239381552571,-0.0235449202923348,-0.095706296750931,-0.0201807974881645],[-0.00462805311021713,-0.0648812394771915,-0.0308670303600837,0.000586806981869747],[-0.00125438226471683,-0.0698312927059895,-0.0572889724498405,0.0340364916182224],[0.0475045384290901,-0.0368742721778121,-0.0141924359390179,0.047196062387395],[0.101322951310687,-0.0759024376586101,0.00918853653756538,-0.0520982618083323],[0.0596820548116284,0.00965552490366977,0.0143624085596026,0.0143533333786682],[-0.13095837110322,-0.0783447433810754,-0.0174904995506339,0.0330878550983124],[0.0155507887906525,0.0520598363700105,-0.0346497772422704,-0.00289750866951401],[0.0217446809698438,-0.0409384856114503,0.0795794529284814,-0.00771502025117658],[0.00786680322128315,0.0129010953046973,0.0119640506538429,0.0095008866815323],[0.0131724295738736,-0.0378957264799073,-0.0791893839235104,0.0828275507262056],[0.0197210461562115,-0.0994857295024866,0.0172993875260016,-0.0364704341442675],[-0.0253206232170541,0.0243259122034524,0.0470016284787435,-0.0623802938278416],[0.0231221072471368,-0.0481237678900407,-0.00189459928109424,0.0333103913421616],[-0.0904345457798774,0.0108378434263408,-0.0503719531125845,-0.0927102195676784],[0.00639946933847274,0.0195958411308389,0.0464113978834776,0.0205540420238836],[0.0332011692505338,0.0544623518569257,0.00424235161421797,-0.035283754391932],[-0.030109686748347,-0.00543419569029906,0.0222839036280919,0.0947463260595685],[-0.012317635957084,-0.00582155782284686,0.0735316109119894,0.0197109187245925],[0.058645641195729,-0.0858413189256286,-0.0352432168864344,0.0548027162832168],[-0.0278766441722063,0.0987973519467877,0.0745052100612103,0.0395316538372011],[-0.0771025901826441,-0.0197243507964335,-0.031247941861979,0.0249298558825914],[0.036002758615511,-0.0344527389092774,0.0381361974215816,-0.0281909785422757],[-0.0223561696931249,0.00723059601305627,-0.0472748811099287,-0.0310966842039841],[0.132423222928897,-0.0699553197429977,-0.0621832112979147,-0.0179063560620402],[-0.0108806353305192,-0.0403378334304909,-0.0416577130563185,-0.023775616475699],[-0.010932971268303,-0.0535213789979745,-0.00555638768808554,-0.148019272536556],[0.0204160570357328,0.0211268890541995,-0.0876392031082884,-0.00155826346464479],[-0.0477038663096359,0.00142654378941049,0.0362507408821343,0.0153825909918898],[-0.0801078355208285,4.766142881208e-06,0.00458306220820793,0.0283082020680952],[0.0204249742901325,0.103848730669065,0.016309685793237,0.0441481984577362],[0.0142107646665889,-0.0383900931234696,0.022453099535294,0.0355167687534985],[-0.0393040478245899,-0.080691620750804,-0.0478062821360347,-0.0559044611204276],[-0.033375079649669,-0.0400233842003016,0.00586490067010236,-0.0163946870689263],[-0.0100351063381166,-0.00313504669304181,0.0699202090027129,-0.0351180320137585],[-0.0307532453147567,0.0595015914686691,0.0563127541873524,0.0777731966330538],[-0.000574047876541609,0.0295378281939175,0.00447378990557042,-0.0443427413152803],[-0.0109746780675043,-0.0200678366426436,-0.0775170247590603,-0.0158077558291839],[-0.0721723955457647,0.0128010413378079,-0.0201330759029342,0.00711730882042898],[0.085182797489878,0.00757133695317408,-0.0474895428571383,-0.0853213356866721],[0.0477476832008833,0.0253062764523651,0.0918563151139917,0.0102559084265291],[-0.0410691863014426,-0.0193035329005954,-0.0265048309370028,0.103764836114511],[-0.00616307539786945,-0.0370160093036639,0.0288784914928473,-0.00396084261608007],[0.10664759523431,0.0458361821627171,-0.0158658739084514,0.0499528274397418],[0.0333869915091051,0.0178890570703151,0.0416721972027091,0.0105193355611138],[-0.0407539840326789,-0.0566340656932956,-0.0646911238177592,0.104232556550217],[-0.00528098103747225,-0.0128885191207459,0.0457120208300477,-0.0810164757384061],[-0.0507637887861488,-0.0490885872214122,0.111128349091374,0.0452702646756234],[-0.02765402997163,0.0298868118662233,0.103085598469916,0.00890339455790972],[-0.0203105118318418,0.00028305894052716,0.00188953341308388,0.0335391555084249],[-0.106841330138345,0.0630523386904166,-0.0390078630446677,0.0971647362839579],[-0.102967747846766,0.00366142530449698,-0.0546382787186421,-0.00675363300784128],[-0.0510529213759151,0.127065807628559,0.0719792238982982,0.00794455065220594],[-0.040860454940709,-0.0500193403162901,-0.0279892517640125,-0.0410391513351211],[0.141432383644795,-0.0882894633529361,-0.0342264788232461,-0.013718823383451],[-0.0283193487153193,0.113270621923521,0.00733036829180386,-0.00520759499533738],[-0.0446190616582346,0.00841923419661613,0.0439168879573584,-0.0371877385169058],[-0.00522810097628909,0.0179538458078243,-0.0307014092657996,-0.0281941318059301],[-0.0998669183282268,0.0164826533665277,-0.00986620751799801,0.0540553050178424],[-0.0222393833475191,0.00520563465668039,0.030202711743552,-0.0447067055182382],[-0.0376687197458661,-0.0137032681201307,-0.0953323688017974,-0.0245786228916481],[-0.0273498893977808,0.0310088082065683,0.0189189237831951,0.0355507610919228],[0.0354571003709624,-0.0116267530071509,0.0246416719761753,0.0491070640150439],[0.0284067163973569,-0.00570309490952584,-0.0335396956675536,-0.0235883428095759],[-0.0280538845110268,-0.037729777747975,-0.0582937277817237,0.0436089831548996],[-0.0136778847236852,0.00507019310392699,0.0241019677791972,0.0442479923581338],[-0.0518846692211629,0.00825702193772703,-0.0619359082141988,0.0239595765095978],[0.00801671530427789,-0.0164606192159164,-0.0462093711323125,0.016666176858144],[-0.0428282550748941,-0.0501337983344594,0.00857552405008997,0.00612944616697562],[0.0395401277660427,-0.0655632180506908,-0.00684552282935398,-0.021657064572403],[0.0218152763623844,-0.00958364096814355,-0.0281048058538109,-0.00506115025616962],[0.0367269806880007,-0.0637680912458517,0.00569278469277118,-0.0259383365296013],[0.0750862676406272,-0.0134271397787997,-0.0715228438827047,0.0863393064749736],[-0.0184489119802182,0.0850685524894437,-0.0474601209422187,-0.0266774965513502],[-0.110234925382653,0.0372793301137342,0.110634766056997,-0.0294863981203135],[-0.0115471847007163,0.0506156134032122,0.0191010964444266,0.0457940045652766],[0.0419425802280098,-0.0675227782714715,-0.0646443216040605,0.101787309356142],[0.0201330344137229,-0.0333953407791959,-0.0869411191051846,-0.0341356295652725],[0.0855675799746488,-0.0213334238252696,-0.0892089944577321,0.0564733750030915],[-0.0666694810188267,0.0640964370181463,-0.0350011718662707,-0.0354757109902821],[0.0050356097018645,-0.0435309381788645,0.0345701730644843,-0.0436980982246004],[0.0523795800089576,0.000365786050721522,0.0436508191013927,0.0117927746462596],[-0.0352558487215146,0.0139632894924486,-0.0538856370365159,0.0706635654881348],[-0.0529559250906409,-0.0485262437787691,0.125291789792069,-0.0496712906592577],[0.0317742582287019,-0.0707517241162606,0.107794905683259,-0.0813982968008978],[0.0462915552923581,-0.00423436240518276,0.0970346011805188,-0.0619898080827805],[1.0676894417571,-0.0494529826930609,0.11099800738928,0.072269871210507],[0.917215938297435,-0.0124869056899012,0.00851907509971018,-0.0383862006785552],[1.06109589366513,0.0101972819144115,-0.0356526673505791,-0.0143261397040043],[0.970184246157087,-0.00113945731725089,-0.0535019308096239,-0.0280608657558524],[0.975638290457102,-0.0342588574312949,0.0705712226988359,0.00765446009181928],[1.06723478150497,-0.0288089769126512,0.0521904977736753,0.0299914541340461],[1.00429879497963,-0.0709705666947946,0.0158636714939341,0.0580873676879283],[1.00505112643883,0.0566906956710742,0.0413918655920818,-0.0707182431856564],[1.03994254496099,0.0705221022100627,-0.0562573976413253,-0.000571966045958142],[1.03335803955869,-0.00946680726005042,-0.0245284442738803,0.0354677527067435],[1.0718278979769,0.0488001118753795,-0.0565688305237545,-0.0969584422070103],[1.11912449922836,-0.000972289140043646,-0.0232136713472766,0.00510584774195081],[1.00097514091942,-0.0145606658390262,0.0691758327799503,-0.0277157998480608],[0.969803354397634,0.0537962045782856,0.0295509241957569,0.031358180891013],[1.00757695720534,-0.10590808239567,0.0636052691550283,0.0478202557074144],[0.954436138332209,-0.126552070506586,0.00583126931113702,-0.00514167879716161],[1.00904552853804,0.0135504038722043,0.0497440951957319,-0.000169041464874507],[1.01767730976624,0.0437737543418569,0.0146901973593814,-0.0591851272047681],[0.964816888700176,0.0392966632947327,-0.00795384880385945,-0.072322163757659],[0.948562370778234,0.000239774605906686,0.0498917862094747,-0.0797968300781364],[1.02136631425334,0.0421113742166223,0.0267976409160276,-0.0883982609617859],[0.954734322884122,-0.0910299716887181,0.0243298908987585,-0.0636965352255223],[0.934143538234245,-0.0335115962091161,0.0280214187541721,-0.0392531824184301],[0.897682695318312,0.0735398689074529,0.0219549179481589,0.065310995140646],[0.969065905970072,0.0216713222569109,0.0577364331052312,0.0608931068384025],[1.0025919556234,0.0459517061311442,0.021227856430852,-0.0245305290242033],[1.01661649374332,-0.0396767992062492,0.0613916074410893,0.01025126864235],[0.870555693081945,-0.0396004735364294,-0.07316071342927,0.0494285924716105],[0.929469900101256,-0.0630988326333227,-0.0459955683621583,0.042474318305294],[0.975483815977099,-0.112297059565205,0.0169928464458435,-0.0356982268408296],[1.03512829713477,-0.0327997528927928,0.0311602238658832,0.0286669195543993],[0.890056445905776,0.0418392407394465,0.0493569333241563,-0.0240637904920569],[1.02178758791296,0.0272547798983306,0.0586806206343043,0.0123321761465145],[0.961651894778374,0.0422675316879507,-0.00180108099854885,-0.0118057525155562],[1.08685493237995,0.100709929188144,-0.0297358150696644,0.0570184963701938],[1.02816771289133,0.0621811720013226,0.0402320709221643,0.0159548502754237],[0.96585195185181,-0.091223220950629,-0.0404269585443709,0.00108019590912284],[1.03907072790436,0.0354620500396104,0.0134425117484429,-0.0286112303840519],[1.03012399786955,-0.0445376060389391,0.00136959864739644,0.0103508192082074],[1.10184310364997,0.0474486446171941,-0.0309041238744603,0.00118321103861077],[0.973811457317892,0.0587135249238945,-0.0427794362298491,-0.0484362588753944],[1.04461956239404,-0.0466749123496573,-0.0315872893703512,0.0481950685650869],[1.00735012520387,-0.034340491639199,-0.0447018539648568,0.0334361523526591],[0.929547701658158,0.0706474331274008,0.0288878839873179,0.00760789459246889],[0.93700240874816,0.0475718757520361,-0.0560298748413715,-0.0902205514777983],[1.04744622453985,0.0490813346699413,0.0340528410182858,-0.0725051287121593],[1.08295981217391,0.035367189171646,-0.0403482662692841,0.0155683768205262],[0.962749740994052,0.019474147911172,0.0281642023189112,0.0830016037923543],[0.982279862855779,0.0158594983473972,-0.0394860975058283,0.0328986219600564],[1.01070108195494,0.0566928202944279,0.000360297533949997,0.129177139205725],[1.11306163533222,0.0964021456862079,0.00500611348255654,0.0322593297182971],[0.968739076815739,-0.0535761682135879,-0.0860832650765614,0.00797341547939307],[1.03449383945947,-0.0136430729435904,0.0242852636870765,-3.64022087030862e-05],[0.997714814435758,0.0432922973350936,-0.0191430637369271,0.00201132439753172],[1.00807073769658,0.0448055435278361,-0.000217221390031547,-0.0108073341563052],[0.934591187316435,-0.071225542862221,-0.0299848177890196,0.011328739726831],[1.10203885634793,0.0361160285657735,0.0036597636079893,-0.0216943959960217],[1.00990380680673,-0.0420250435979055,-0.02542888286929,0.0449523680443618],[0.857694033457823,-0.00908829998237652,0.046082211667605,-0.0701706626429492],[0.988637067044352,0.0557067436050523,-0.0789340445999673,0.0270115380132234],[0.906626140869564,0.0874351809715525,-0.0667583397996724,-0.0194605015716924],[0.977490530128926,-0.017995035593044,0.0656164052123563,-0.0377051039506024],[1.04259682541505,0.020387798508168,-0.0765333232333121,0.0281470157749808],[1.06262508730015,0.0945486429882593,-0.0419676137688609,0.0579910450804034],[1.07145441321054,-0.0645003443694206,0.0121572315270724,-0.0326842639212816],[1.00771794429203,0.0122402921215148,-0.0315823221172601,0.103932219713163],[0.871428279417464,-0.0127284358204814,0.025444697759236,0.0478402320334285],[1.03741324748613,-0.0622807455139995,0.0223909396913262,0.0242721623815638],[0.948373298648814,-0.0729646932768073,-0.000118443724741845,0.0177253066906283],[1.06091702548768,0.0240853100099242,0.0226236766301103,0.0776882081587965],[1.00229566412668,-0.0312095334013614,-0.00133702063897595,0.0714700520222457],[0.924104771993609,0.0244375558350717,-0.0149264812791975,-0.122073049599273],[1.013388877861,-0.0178291452476253,-0.0437785478226326,0.15360399381105],[1.07271269534394,-0.0216523892483329,0.018686471649621,-0.0176072104485025],[1.04293234604294,0.00539581525662122,-0.0294583612906879,0.0132995278382729],[1.05414109715074,-0.0271137248923027,0.0164224291600084,0.00345971590295636],[1.10512873689336,0.0795308729534304,-0.0603432216747442,0.112219660739356],[0.966099642110664,-0.0500559471768129,-0.00672667304295105,0.00176088888855953],[1.04630042207761,-0.053299918882736,0.013181060577352,-0.0957948460709295],[0.997085459049386,0.0170215427984395,0.0192093264401556,-0.00836607922766159],[1.0056478545866,-0.0508483895178835,-0.0130253319424158,0.00334982288390138],[1.05287414516575,0.0409542484397137,-0.0865946038047216,0.0207631326677322],[1.04838737413212,0.0182013402150285,-0.049292262243504,-0.0240281941790348],[0.932425311888773,-0.0319782848142779,-0.0218753010156038,-0.00973231833931639],[1.01922189563293,0.0521116508561093,-0.0113144871722094,0.0245481759636909],[1.03860919375079,-0.0763264341845097,0.012639952239705,0.0226535431566854],[0.991327121323979,0.051619260886006,0.0212160139635016,-0.0155554494706337],[0.980929773988133,0.00928863047640091,0.0646505530686544,-0.0164531818150587],[0.942162678565272,-0.0692157785551974,-0.0480441094516826,0.00566534005818801],[1.09388109126327,-0.0320004152120849,0.016525439769618,0.000808724020398848],[1.06431547002476,-0.0356952596644321,-0.0196548576348709,0.026726022994373],[1.00743234044574,0.00453777569857854,0.0602483815578869,-0.111016256252143],[1.00674294665672,-0.0686014460794125,0.0905479226112007,-0.0433427337969934],[1.01650049219261,0.00505051960238053,0.0733735175734362,-0.0572641544342491],[1.00659588472706,-0.0645070248630053,-0.00722275769686445,0.0528843770044844],[0.970386203038572,0.0189423325112912,-0.00148174136726644,-0.0924573714287332],[1.04110102165914,-0.0691584584548645,0.0381415032812036,0.0882053583553225],[1.05912935629901,-0.00768647316328093,0.0419633415122372,0.0257576986984925],[1.08655955675695,-0.00255947445536923,-0.0430094617378356,-0.0491605204781525],[0.948351453526372,-0.0806122929513771,-0.0677218563303045,0.0401156153841756],[-0.0494326183354306,1.02741305137406,0.023154877392784,-0.0658095057852874],[-0.0567596088332982,1.05562822248222,0.0329529820157572,0.0622002001075918],[0.00955219792491811,1.01080874720163,0.0440834203437691,0.0121299481982724],[-0.0558259618671439,0.964458483811047,-0.0416208635398896,-0.0105448495277102],[-0.0154410634695223,0.954822189546069,0.0486418462936129,0.0258886633077222],[-0.0837671701535938,0.943695198085185,-0.0155082255769406,-0.016168152273243],[0.0551274945736889,1.06254702441654,-0.00475601500147301,0.0655840168668599],[0.0789814862586791,1.08631357081957,-0.00561725817220619,0.0301906362676084],[-0.0175501218387108,1.12804645430816,-0.0253686642075303,0.039072025551489],[0.0120258485788823,0.967951391108265,0.041261975138912,-0.0550688589731343],[-0.0108651949073975,1.00134761937687,0.0180808304973027,0.0111620033374812],[0.00283580298681512,0.981630359077198,0.0502681350271765,0.0415362568749675],[-0.0165689520496176,1.18732734114915,-0.0306761773203028,-0.0197709563848838],[-0.0149599018360843,0.943346598669952,0.0448546750734365,0.00302032375863658],[-0.0660603858285091,1.15358108589261,0.00797937720672857,0.0112643785389086],[-0.00819922309234529,1.01018819215419,-0.054028867046952,0.0528083938339871],[0.0089377313839266,1.00658669878196,0.106588066289816,-0.0419904479319685],[0.0316392319119794,1.02115674562607,0.0451309495799135,-0.0350319652791118],[-0.0041059345430542,1.02789625270301,-0.049130560873548,0.00541431766586309],[-0.0294426776634978,0.9922308862945,-0.100296871945693,0.0519271289197189],[0.0077823658423155,0.963261082402183,-0.0262243238987121,0.011633607034706],[-0.018286655830339,1.0230716830743,-0.0105049784938353,0.0331811468937167],[-0.0165490426947807,0.977935313747801,0.0250190936150533,0.0419895280702517],[0.0260762992327036,0.965330660211933,-0.080252003275296,-0.146075912118929],[-0.0358905685760363,1.04854310740164,0.0726395001920094,0.0315766909137036],[0.0127132846599207,1.09047854414494,-0.0617889477723283,0.00999549684760277],[-0.0349802326564767,0.959967703746645,-0.0328970285358898,0.0326998325985032],[-0.083483171157693,1.02026313999099,-0.00555279754256942,0.00479048959808347],[-0.0354490354848211,0.976616189765882,-0.00473988476435244,-0.0115666024560811],[0.0337652781792578,1.06627051072178,0.0151602016661866,-0.0499107438360323],[0.0106182560957611,0.948179964811495,-0.0431259920334149,0.0588861786246721],[-0.0126682042451295,0.956965743382236,-0.0431130806392149,0.0157384979862518],[-0.0963050863811171,1.03769672138218,-0.0339012565030188,-0.0509286813116256],[-0.130308937886529,0.904376055973524,0.0301111057528806,-0.04382323822324],[9.66239636048159e-05,1.07892100836391,-0.0315626304527147,-0.0429859056632472],[-0.00488954164463625,0.972824793584575,-0.0369990223326467,-0.0826930126149903],[-0.0526262942905965,1.00276066167897,-0.0132255324889442,0.0826947263487881],[-0.00656239381679764,1.03502484512326,-0.073947712299798,-0.0518020189565477],[-0.030656853827364,1.05821246380473,0.0152436442829838,-0.0117108909376228],[-0.0238828226104121,0.980965223405435,0.0274498020270431,0.0213689395593849],[-0.0265381137562583,0.94459186683003,0.0383920895592353,0.0734114493063615],[0.0549831518544844,1.08143422343304,-0.134325190437101,0.0495373286226031],[-0.0717459130563085,0.896391208316127,-0.0755940493129373,-0.0264706635794117],[0.035105133789182,0.930661095062034,-0.0507115487061599,0.0170880294139295],[0.0461657919477435,0.966515942842565,0.0348890623332652,0.00227360673640119],[-0.0257967073094707,1.05408884620787,-0.0452537589081947,-0.0446619035275006],[-0.00396217224383803,0.937086780372567,0.0280216595625523,0.037608308054557],[0.000827649101508607,1.05930964508947,0.0263892383914326,-0.00694522638841892],[0.0596002625740395,1.02734695955743,-0.0958775996222556,0.0186550681097461],[0.0700221619639842,1.04261319770565,-0.00295598127662224,-0.0317960658092632],[0.00542587912402561,0.916826215282233,-0.0755604399253736,0.0137580039051409],[-0.0456509989890389,1.02597493937703,0.0421523854899678,-0.00397856590903276],[-0.00789351496162969,0.938902805335286,0.00142507812297221,-0.0500911295431947],[-0.0180360762904519,1.04357491158743,0.007597656069248,0.0270973856440769],[0.0702260289665637,0.94532261172502,-0.057425184082361,-0.00496588228742714],[0.00980754669156488,1.04702482444251,0.0139602855444057,0.0632175783775621],[-0.0761326820821826,1.06462934332516,0.0226304284657197,-0.00900041580508287],[0.0274745843396861,1.00749862676877,-0.0939841200077747,0.0214688088785148],[0.040413197131724,0.985721108501082,0.139189551323736,0.0285457349169335],[0.0287845152530044,0.965217784995348,0.0613409363236741,0.114738463565393],[-0.00354631413575543,1.05875711766538,-0.00691234809552607,-0.0327147645742546],[0.0390326436733465,1.09723216376673,0.0062515299055581,-0.0238032315921914],[0.00853875129453196,0.94839511193402,-0.00249437984307613,0.00196528437840475],[0.0544009145329582,0.940576182387176,-0.0123857339988263,-0.0686330227791494],[-0.0714054139008392,0.97051618988367,0.0367322892576726,-0.0160670487866737],[-0.0304090722257093,0.992925847492895,0.0270717905065563,0.0732979453887056],[-0.0277488934552939,0.961265713770305,0.0285394677508406,0.0148298758431536],[0.0392058638634569,1.0121696268883,-0.0176842840913973,-0.0352213750142252],[-0.0395951395282076,1.03902321062408,0.0692900156598566,-0.028392772826364],[-0.0422886442344935,1.03903766915801,-0.00247350384769097,-0.0249921671880227],[-0.00753073038647904,0.989580954394545,-0.022916434355388,-0.097766394908297],[-0.0550746224604418,1.05027729723064,-0.0399449382757479,0.104572318372634],[-0.0257896867772557,0.998567326006221,0.0110988244182108,-0.0278216512731255],[-0.0697709314249294,0.959336670860389,-0.0251748961084818,-0.0500110468565684],[-0.00178321071919997,1.04361018652072,0.0757667558988378,-0.0653301749894664],[-0.103102554088541,0.896810802630836,0.0856693831709203,-0.0288229778304126],[0.0523655420196183,0.916824659156889,0.050650964915495,-0.0082779718201345],[-0.0385376615211972,1.08515796380589,0.0811358651758108,-0.053860220069626],[-0.0275919869093723,0.906611174028835,0.0471920871144755,-0.0441692937324245],[-0.0177967740013305,1.01769335805888,-0.0746315346026861,-0.1013802949836],[0.0348747586996351,1.07702061707807,-0.0300411047130904,0.00508227057182221],[0.000237828392608004,0.913484370578131,-0.0142519703123409,0.130537974449624],[0.00342358462924089,0.977545431698743,-0.0203992900377262,-0.0139091961721026],[-0.0595383262652557,1.04377079852471,-0.0310386469821382,0.0173426838596576],[-0.0357225350193297,1.06991118102191,-0.0111827421830648,-0.0153798207266556],[0.029880690463603,0.993693622826041,0.0273774745209477,-0.00641712094265631],[-0.0681947543227476,1.02979581671738,-0.0229714467935874,0.0735889903356502],[-0.0260342199414636,0.973559057151589,-0.104016477588254,0.00301068853188203],[0.0412113428448971,0.94302732576884,-0.0713133146556288,-0.0635150965810152],[0.0488010867799635,1.03749408726997,-0.022353369543032,0.00219557474263465],[0.127917458687521,0.946457203318014,0.0596071346837879,-0.0721097000733543],[0.00547096273268217,1.0583687342093,-0.0365021998607469,0.0508290579041723],[-0.0176381865046318,1.06052227411824,0.0196338984031612,0.135032207084222],[-0.0468546092930319,0.990519696722066,-0.0348866044524252,-0.00280343058870877],[-0.0254616569636251,0.999302064169838,0.01100116803612,0.028501328634275],[0.0574718879665642,1.06500219540212,-0.0553686635696446,0.0105779408583159],[0.0129136986714353,1.07816035515579,0.0323640833934088,-0.0328685663159899],[-0.00935184161483458,0.951349149463781,0.00805393871097021,0.0241400320832313],[0.112344348974489,1.05636877165659,0.0211768264005302,-0.0179347796548927],[0.0563628030210834,1.01018844539474,0.0512580704385703,-0.00810568709165353],[-0.035575901009663,-0.0125241799813513,0.931384849525744,-0.026502262222832],[0.0868563336652707,-0.0417324222388044,1.02661215883906,-0.0413364203022365],[0.0025277695999963,-0.0949979181215084,1.04988117569335,0.0879646688906992],[-0.0839271684280128,0.0485029818993487,0.967550614774336,0.0430088069521662],[0.000381080068160408,-0.00608213673403612,0.90374098597179,0.0725500573987496],[-0.0389313961745998,0.0453199300297843,1.09634078866511,-0.0260804530762373],[-0.00870005054938832,0.0608195242847767,1.01449463736251,0.0235429196141612],[0.00410930973628877,-0.0855755808786737,0.861894840726339,0.0504882830242504],[-0.0366248473479423,-0.0265550221520388,1.0106380708631,-0.0375380953504728],[0.0663311409649469,-0.0436113051854024,1.0229812913321,-0.0258742711426625],[-0.0207102332439319,-0.0597211754686071,0.993053972114802,0.00245326097989474],[0.0351912911932423,-0.0543570072165824,0.99059946237078,0.0607507659443936],[0.050300618929045,-0.09281817622001,1.05531084088966,-0.002815422696331],[0.0354272351474448,0.0158658329490775,1.00005022587869,0.00853800892362783],[0.0183883508854588,0.0263609910631207,0.991613746153018,0.0231763414481058],[-0.0241727379038952,0.00822449814938237,0.999226847668,0.0455684678797183],[-0.043383404921436,0.00525511191446267,0.954783501054301,-0.0733461841576437],[0.0172985171549499,0.00164372506066713,1.01158155132552,-0.0441402679040194],[0.0305036958420396,0.0294265939462929,0.95855683147314,-0.0105243313063667],[-0.0642556115123255,0.0294194591035542,0.940546907748208,-0.0315949084505666],[0.00209247639405939,0.0261260909678962,0.97281374421554,0.0151336925869012],[0.126757986916913,0.00809300172183807,1.12843200084608,0.0611558567358422],[0.0240264658502388,-0.1027955955602,1.00810821803713,0.0341883089668695],[-0.0158035559301209,0.0287496155192903,1.00978775723395,-0.0638128794499061],[0.017471683955029,0.0240497924078366,1.02064734526708,0.0479482011886724],[0.0758561323769883,-0.11179503491421,1.02267451038703,0.03482748013504],[-0.027233519166935,-0.041528327221758,0.969219938326796,-0.0919406371804095],[0.00525235541329111,-0.0107408257749261,0.985351732198014,-0.110420676024212],[-0.0979653395570742,0.00527699492553526,0.971123350031114,0.01833440894067],[0.00986502738146406,-0.00842606146186216,1.04169099303763,0.0162779315780891],[0.128322696502239,0.0126064180650096,1.06613245707256,0.00492629208228407],[-0.0208756195848191,0.00637755802211918,0.973373904463322,-0.0346641377903169],[0.021245776803869,0.0940045036777136,1.04239773035449,0.0472287037604996],[-0.0470297382235242,-0.0707577615491818,0.959899139879267,0.112670266598343],[-0.0468969548567244,-0.0208445124035808,0.95887874759336,0.0943143417479859],[0.0127461803859891,0.145201706516502,1.0582566599276,0.0481685339208524],[-0.00235795845480366,0.059450544990034,1.02423490065007,0.00379409704560223],[-0.0558097730660592,0.00385727094439925,0.976953980473296,0.0636062790773473],[0.122444548867612,-0.0880967631962005,0.969171960392693,0.029102320188572],[0.00356597162662387,-0.0127204399167934,1.10931615607842,0.0710450352912463],[0.0176380076745713,0.0365022410024504,0.99327133221908,-0.00546669287544376],[0.0337029696182311,0.0200947964160339,1.01749199724317,-0.0112622726244956],[0.0105254815021752,-0.0261470333365786,1.00608781313117,-0.0369566327888084],[-0.00711892422895728,-0.0757707027810844,0.976222534703242,-0.0364611479588568],[-0.0702599954630796,-0.0886150927248708,1.00396909251038,-0.00222077063166429],[0.0129416404090728,0.0452090430653713,1.03103628439619,-0.0880490545416171],[-0.0279834262592867,0.000292477496821735,0.966578286692757,0.0531044502576855],[-0.0122225026667397,0.0339173178475879,0.877920306176152,0.0785515141108353],[-0.0289300330922819,-0.00153547731504577,1.02032688489382,-0.0494163332548389],[-0.00763305448634949,0.0348510032463901,0.957342308858602,0.0436132495870121],[-0.0260797413150902,-0.0578293627668065,0.968138685014235,0.0187834972215409],[-0.0244532657770483,-0.0280280767929735,0.933845649380409,0.00776236735626566],[0.00522446715945975,-0.0347914714900728,1.02660386144047,-0.021240402158391],[-0.0246486854976545,0.0288664834012941,0.996966226278758,-0.0183479724402607],[0.0988445422989723,0.0121139230549747,0.911727498308155,-0.031998181504478],[0.0304733880468987,-0.0962625774957452,1.00087210520421,-0.0411815821157374],[0.0134432634314497,0.00622496889865848,1.01776427922178,0.098398941893958],[-0.0551336255394208,-0.0840883299232056,0.952703068988228,-0.138625525145636],[0.0448751340232728,0.0352727683846691,0.951854854970349,-0.143225901578334],[-0.0477875332930037,-0.0102634852752882,1.01450309513552,-0.0205188322312527],[-0.00557529844349638,-0.0328252018784119,0.948825972455469,-0.125217104750439],[0.0123697264590828,0.104061157512407,1.00489880710101,0.064721990294011],[-0.0344954179540843,-0.066912556717258,0.942370716669262,0.0285892412600939],[-0.0943464338414414,0.144412009591488,1.00480192077703,0.0438711533563631],[0.0172988155412846,0.0213739040321869,1.03408667940145,0.0617889387524178],[0.0290737425213326,-0.0292220987386334,0.873516577164482,0.139871221115946],[0.0436356309049238,-0.0435151719675373,1.00290505861142,-0.0409751905045435],[-0.0325676443577773,0.0727760540167648,1.09891185070826,-0.0318216739629839],[-0.0327747417436941,-0.0693653396318075,0.999609655484021,0.0317066870833663],[0.0235364212213069,-0.0399552088705495,0.945708339159023,0.00256454662429201],[-0.137479679837264,0.0604720453123094,1.03898491859072,0.000515771540912865],[0.0406767504914015,-0.0419813023627885,0.952646908181105,-0.020413361805634],[0.0126279465713797,0.0509419345569874,0.983003941833775,0.0114852258200495],[-0.0893891869938569,0.0387927973348086,0.933992594086599,0.0310102668705658],[-0.00956421344303073,-0.00895553009171072,1.01569551293804,-0.0395679712863415],[0.032388307061417,-0.0188659882193832,1.04237397519331,-0.00407694204293529],[-0.0316745871307597,-0.0200466314074148,1.00565519599685,-0.0717849559370309],[-0.0354526113432296,-0.0190192293937896,0.947989144826711,-0.0115461316008973],[-0.0674071547839915,-0.0250213387977882,0.986497091914621,-0.0851683583869862],[-0.074382910742193,-0.0108968312724773,1.08254356880039,0.0460165386676546],[-0.0138133491397942,-0.00326744212665404,0.93891429092105,0.00991389768666651],[-0.0373375550027188,0.0450732091667267,1.09063040681101,-0.0108034677154382],[0.0797314931294381,0.00439557334487658,0.951026929651639,0.0101484587304841],[-0.00318485191270062,0.0869880781590318,0.964394027694704,-0.0821237690670064],[0.0333059976277833,-0.0324867723384258,0.893914351673655,-0.0542158412406557],[-0.0694352093982851,0.0317803536322972,1.01239303097469,-0.00481948719856952],[0.0049519380626936,-0.0333017025352488,1.04278074536316,-0.00193054855781438],[0.0527690614550875,0.0433288744459499,1.00476834139657,0.054567006066243],[0.0476303523733059,0.0485893066200686,0.945756976542554,0.00897379743395827],[-0.0938370004181703,-0.00421328212282901,1.00354533170073,-0.0697924556688885],[0.0769860672802999,-0.107479048534331,0.983172879260845,0.0695783739877529],[-0.0280066952174765,0.00238154696480925,1.03239142504137,0.00759966819245523],[0.0767958559504076,0.0677260671377737,0.92214444918623,-0.104178974050149],[0.0600317756299716,0.0310368266110434,0.967492807512747,0.0156333549057521],[0.0431940590226263,0.108905911190458,0.981032938458293,-0.0266030267237952],[0.00910990884784502,-0.107830219133903,1.00961993044523,-0.00480502741539704],[0.0344036276790379,-0.0397224455738548,1.01496324833979,0.0391935425849609],[0.175539044421424,-0.0502905545800094,0.996529457258318,0.0425528055069795],[-0.000640447366605419,0.0500324943433496,1.08198532556014,0.0642659935851061],[0.0801817743177605,-0.00511532945201401,0.952968957480929,-0.0541060529593916],[0.0586494340079433,-0.0868587934052434,-0.0240085297206516,1.04757762877606],[-0.00454696270975944,-0.0320095999205306,0.0584209338286897,1.0110157480459],[0.0589125138145033,0.0272527558152302,0.0695620441461091,1.00054558712659],[0.0562461762187083,0.000347071628616985,-0.0680174967469812,0.950123777383089],[-0.0988946443031802,0.0839363073709393,0.0348653169170908,1.01242826904661],[-0.0259945493116685,-0.0398082099237466,0.041024634575616,1.06332316462948],[0.0310111853408065,0.00835919074505071,-0.0194184105139811,0.930286273724689],[0.00109163415985107,-0.0335689056847697,0.0193863637480441,1.00951131236865],[-0.00318946776318883,0.0730024325777946,0.0309404927625213,1.00131477032722],[-0.0113953916070123,0.0341053775194329,-0.0529928761001395,1.14241072714998],[0.0431479072008462,-0.0295741864999133,-0.0884590207627804,0.926455366151853],[0.000357365073801466,0.0104126417505498,-0.0146505733353621,1.07145688211759],[-0.0123872310879513,-0.000218992351976415,0.00679142940167747,0.938284649001576],[-0.00760056968233918,-0.0291621247731809,0.0604387311408285,0.939352459440816],[0.0352561798168459,0.00108788564374458,-0.0471346107653127,1.02619476403448],[-0.0358459553044754,0.0061873312862965,-0.00408765456833712,1.02284118818885],[0.0282343071832196,0.0414256042603566,-0.00862062959672039,1.00067002288014],[-0.0618711633058474,0.000598709839224933,0.0756711234410478,1.05196675995653],[-0.0272630062041571,-0.0516331451858092,0.0140538185873378,1.00174079998601],[-0.00766798998879653,-0.0692202821327701,-0.0869717890349204,1.01068276048515],[0.0330279826578074,-0.0308649041053932,-0.0235422412690175,1.04820621624527],[0.00723028771857451,0.0720496865150575,0.0836220428295623,1.03913406189386],[-0.0914541539486626,-0.0276188807874533,0.0295355439122524,1.1022777712709],[0.0199768063525776,0.0163453947349491,0.0176168850125216,1.03999621628192],[-0.0312833415990718,0.132567429630416,-0.0659604299924249,1.01945362840704],[0.00705037591840617,0.0757485253952886,-0.0490578546944977,0.953362545002544],[0.0875913782109314,0.0208261218585479,-0.0655848876965557,1.00427617880217],[0.00650431559755605,-0.0137942249804969,-0.015224146111437,1.01449595022456],[0.0637551469076773,-0.0437249809005731,0.00233322555299363,0.975097896038521],[-0.0132219755821849,0.00581165078889791,-0.0432626762397968,0.961004578097968],[-0.0124075257212346,-0.0478715099548664,-0.0153580252112688,0.941815021821477],[0.0100986436420249,-0.0259883482356798,0.0339347851278375,0.982658092130369],[0.0315966332407083,0.0263971076495597,-0.0203261697505749,0.952408676999072],[0.0960855984836602,-0.0380228792980993,0.12110710400639,1.05566458135552],[0.0669626537983638,0.0657121812463016,-0.0454442363445794,1.01777989617382],[0.0115976580233476,-0.0381863127339322,0.0362534073633781,1.02475874491026],[-0.0112978320774469,0.0136615693353954,-0.00842214586813262,0.951520263951896],[0.0397613606014291,0.0562040276673625,0.0645588876133901,0.969198791443103],[-0.000863667267737827,0.047826222108607,-0.0332016096519427,1.03311394353712],[-0.000351428389978305,0.0679409097895369,0.00556711417880671,1.05953255122713],[-0.0593027783148131,-0.0427135875897535,-0.0202102502844223,0.803104229110185],[-0.0076266812186004,0.0747049309791749,0.0371277187284316,1.00198902334831],[-0.028213031824812,0.076272035041114,0.0360741290593881,1.11978737302116],[-0.0488392483248926,0.0820995282111301,-0.0104513510117171,1.03574738193028],[0.0361536912082264,0.099086613070905,-0.0892867545553291,1.07782811249902],[0.059969199368411,0.0325230893863113,-0.0721350816130606,1.08382525037616],[0.0165479908660527,-0.0728724561052364,0.0437422567318149,0.96534942947928],[-0.0114086700680145,0.053343508222676,0.0118857608477074,0.970632294891786],[-0.0191485494624925,-0.018137500929458,0.0017521244553577,1.05307335968222],[0.0259635064316972,-0.0322972643345557,-0.0364300652389281,1.03643192597727],[0.0066708378920465,0.0760887461454046,0.0574111817238603,1.01145199613627],[-0.0103707236404557,-0.135976039639282,-0.0220276831259069,0.993140703972804],[0.0071405827516767,0.033847299760959,-0.0189343362749571,0.984404242407443],[-0.140854130926258,-0.0394309203620312,0.0135330808184218,1.06064070771443],[-0.021459593005535,-0.123804971119617,0.00686940956410545,0.978711325865756],[-0.0857091975202243,-0.0434692563198038,0.0519103315499033,0.992257306158709],[0.0272804218911481,0.022617030463824,-0.0624023411484098,0.949401352629244],[0.0183537619419068,0.037442768729158,0.0742934280542086,0.938818724991759],[0.0261679215950929,-0.024282094275507,-0.0373432395873528,1.07703582933995],[0.00253106597668311,0.0399839216792318,-0.0110343311555033,1.09198641646402],[0.0592094338236127,0.0154165388199466,0.0293835256839028,0.966035270013723],[-0.0344052716035007,0.0475489199014849,0.0286887338785422,1.02713224437638],[-0.0813194388343549,-0.0975973128609608,0.0458022626065846,1.00321671985853],[-0.0855602104090136,0.0720786110303273,-0.00990815664715709,0.843196257359121],[0.0764860293816923,0.0375778924603328,0.00557105205536882,1.02851107930054],[-0.0177035690799216,0.0133790046845631,0.0404732239040454,1.08940216769865],[0.0382336552247046,0.0261685811632735,-0.0307505358812118,1.02487900367567],[-0.0218408073965109,-0.0320759637189003,0.033214662993783,0.941612976934822],[0.0790929490385566,0.0694593568060996,0.0506250491070062,1.05724370438251],[-0.0355987137292267,0.0322450665128674,0.0121995592834783,1.04307716139998],[0.0698225770948451,0.0213728815933317,0.0035946351094602,1.05007387684],[-0.0239542729970344,0.0394119494031369,0.00661365773823924,1.05577049196921],[-0.030189181530647,-0.0339381357654362,-0.0297882418033941,1.10220247107266],[0.00727419233527376,-0.0373858423732625,0.0191795374990071,0.941705681373471],[0.0513709614987572,0.0721619545433118,0.0966142163437777,0.904625651409078],[0.0112661327709577,0.0116621430451031,0.0177641813580141,1.01708380915597],[-0.0553187256967324,0.0178459100256332,0.0197714771239303,0.947774912644114],[0.0922247204566532,-0.094905017499283,-0.00984230785516663,1.08908172814787],[0.00027194770705782,0.0623415515142061,-0.0837293463146218,1.02983565280549],[-0.0294071554533583,0.0294108825214522,0.0347727706094363,0.990357527255393],[-0.0288594035114364,0.0390974334443161,0.0211716167494357,1.02925449195378],[-0.045003478149215,0.0643433212733947,0.0435522566217425,0.990523300722042],[-0.0286460059663427,-0.113005741669739,-0.0148069002389699,1.13417478809932],[-0.0451593866733697,-0.0170544745306571,-0.00549312302356501,1.14502173582412],[-0.0227594913908694,-0.00689273844123576,-0.00881147708068447,1.11799919965517],[0.0191066150999781,0.012164579456584,0.00414272917002762,0.977976142500763],[-0.0957690423977697,0.029483748931064,0.0878679071014018,0.942366066775934],[-0.030255910728618,-0.0420016843834784,-0.113178185393222,0.930996743642186],[0.0490506615470954,0.0518293259369107,-0.019595046543574,0.983350426809705],[0.036487052387965,-0.0481854837060533,0.00377642225871966,1.00353694608112],[-0.0191820178072976,0.0868693198876349,-0.0206730499125247,0.998621967405031],[0.0468971742837991,-0.011960806194553,-0.0174489426934879,1.04311859097923],[-0.0187450171306476,0.0181669112094454,0.011848201239981,0.993756831973989],[0.0225717306535978,-0.0434315720568381,-0.040873894866745,0.915352119145527],[0.0322928920951838,0.0315290980811075,0.0395471725624311,1.00166597501206],[0.00894458395486917,-0.00275046420827272,-0.0466346094871864,1.02484712923845],[-0.0430890995718961,-0.00830428473603035,0.00638145423890386,1.07276399787677],[0.0632979426879143,-0.00606325488719855,0.00683704542356536,0.914180675523942],[0.0385444376824944,0.0379395132549522,-0.0149329720441703,0.985958372418287],[-0.0466772365545968,-0.0513408646511535,-0.053975347905506,1.00946018632504]],"center":[0.199316630029878,0.199523859296828,0.197968307840991,0.203129728507293],"scale":[1.13786634278435,1.13786634278435,1.13786634278435,1.13786634278435],"colnames":["x1","x2","x3","x4"],"rownames":[],"group":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],"levels":["Class 1","Class 2","Class 3","Class 4","Class 5"],"extraAxes":null,"extraAxesNames":[],"lineFrom":[],"lineTo":[],"lineColors":[],"axisColors":[],"levelColors":["#1f78b4","#e31a1c","#33a02c","#ff7f00","#6a3d9a"],"colorVariation":0.3,"pointSize":1,"crosstalkGroup":null,"crosstalkKey":null,"state":null},"evals":[],"jsHooks":[]}</script>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Original data of five Gaussian clusters in 4D.</figcaption><p></p>
</figure>
</div>
</div>
<p>Let’s visualize 2D embedding with default neighborhood parameter value.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ## tSNE</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># random_num2 &lt;- runif(1, min = 1, max = 10000000)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(random_num2)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># tSNE_fit &lt;- data_pca_n %&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   Rtsne(perplexity = 30)</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># tSNE_df &lt;- tSNE_fit$Y %&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   as.data.frame()</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># names(tSNE_df) &lt;- c('embedding_1', 'embedding_2')</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># tSNE_df$type &lt;- rep("tSNE", nrow(data_pca_n))</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ## UMAP</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># random_num2 &lt;- runif(1, min = 1, max = 10000000)</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(random_num2)</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co"># UMAP_fit &lt;- data_pca_n %&gt;%</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   umap(n_neighbors = 15)</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># UMAP_df &lt;- UMAP_fit$layout %&gt;%</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   as.data.frame()</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co"># names(UMAP_df) &lt;- c('embedding_1', 'embedding_2')</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># UMAP_df$type &lt;- rep("UMAP", nrow(data_pca_n))</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Phate</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co"># random_num2 &lt;- runif(1, min = 1, max = 10000000)</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(random_num2)</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="co"># tree_phate_fit &lt;- phate(data_pca_n, 5)</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="co"># PHATE_df &lt;- as.data.frame(tree_phate_fit$embedding)</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co"># PHATE_df &lt;- PHATE_df %&gt;% select("PHATE1", "PHATE2")</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co"># names(PHATE_df) &lt;- c('embedding_1', 'embedding_2')</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="co"># PHATE_df$type &lt;- rep("PHATE", nrow(data_pca_n))</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="co"># ## TriMAP</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="co"># source("functions_tri_hex_TriMAP_without_pc.R", local = TRUE)</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="co"># source_python("Fit_TriMAP_code.py")</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="co"># n_inliers_n &lt;- as.integer(12)</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="co"># n_outliers_n &lt;- as.integer(4)</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="co"># n_random_n &lt;- as.integer(3)</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a><span class="co"># tem_dir &lt;- tempdir()</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit_TriMAP_data(data_pca_n, tem_dir)</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="co"># path &lt;- file.path(tem_dir, "df_2_without_class.csv")</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a><span class="co"># path2 &lt;- file.path(tem_dir, "dataset_3_TriMAP_values.csv")</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a><span class="co"># random_num2 &lt;- runif(1, min = 1, max = 10000000)</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(random_num2)</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit_TriMAP(as.integer(2), n_inliers_n, n_outliers_n, n_random_n, path, path2)</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a><span class="co"># df_TriMAP &lt;- read.csv(path2)</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a><span class="co"># names(df_TriMAP) &lt;- c('embedding_1', 'embedding_2')</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a><span class="co"># df_TriMAP$type &lt;- rep("TriMAP", nrow(data_pca_n))</span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a><span class="co"># ## PaCMAP</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a><span class="co"># source("functions_tri_hex_PaCMAP_without_pc.R", local = TRUE)</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a><span class="co"># source_python("Fit_PacMAP_code.py")</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a><span class="co"># knn_n &lt;- as.integer(10)</span></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a><span class="co"># init_n &lt;- "random"</span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a><span class="co"># MN_ratio_n &lt;- 0.5</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a><span class="co"># FP_ratio_n &lt;- 2.0</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a><span class="co"># tem_dir &lt;- tempdir()</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit_PacMAP_data(data_pca_n, tem_dir)</span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a><span class="co"># random_num2 &lt;- runif(1, min = 1, max = 10000000)</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(random_num2)</span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a><span class="co"># path &lt;- file.path(tem_dir, "df_2_without_class.csv")</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a><span class="co"># path2 &lt;- file.path(tem_dir, "dataset_3_PaCMAP_values.csv")</span></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit_PaCMAP(as.integer(2), knn_n, init_n, MN_ratio_n, FP_ratio_n, path, path2)</span></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a><span class="co"># df_PaCMAP &lt;- read.csv(path2)</span></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a><span class="co"># names(df_PaCMAP) &lt;- c('embedding_1', 'embedding_2')</span></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a><span class="co"># df_PaCMAP$type &lt;- rep("PaCMAP", nrow(data_pca_n))</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a><span class="co"># expample_2 &lt;- bind_rows(tSNE_df, UMAP_df, PHATE_df, df_TriMAP, df_PaCMAP)</span></span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a><span class="co"># expample_2</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(expample_2, "Example_2.csv")</span></span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>example_2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Example_2.csv"</span>)</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>example_2_with_label <span class="ot">&lt;-</span> example_2 <span class="sc">%&gt;%</span></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> embedding_2, <span class="at">color =</span> <span class="fu">rep</span>(df_2_n<span class="sc">$</span>class, <span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#1f78b4"</span>, <span class="st">"#e31a1c"</span>, <span class="st">"#33a02c"</span>, <span class="st">"#ff7f00"</span>, <span class="st">"#6a3d9a"</span>)) <span class="sc">+</span></span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Class"</span>)) <span class="sc">+</span></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>type, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>)</span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>example_2_with_label</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig4-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4: 2D embedding by t-SNE, UMAP, PHATE, PaCMAP, and TriMAP</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Five well-separated clusters are in low-dimensional space, with different shapes in each NLDR technique (see <a href="#fig-fig4">Figure&nbsp;4</a>). The next question that comes to your mind is whether the distance in high-dimensional space preserves in low-dimension (see the blog).</p>
<p>Until now, we considered examples only with clusters. Let’s see what happens to a 2D curvilinear in 4D space.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202303003</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="sc">-</span>(x<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">500</span>, <span class="dv">0</span>, <span class="dv">3</span>)) <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">500</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">500</span>) <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">500</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">500</span>) <span class="sc">-</span> <span class="fu">runif</span>(<span class="dv">500</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>df_2_n1 <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x1 =</span> x, <span class="at">x2 =</span> y, <span class="at">x3 =</span> z, <span class="at">x4 =</span> w)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">langevitour</span>(df_2_n1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-fig5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div class="langevitour html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-5df96d0d69485213ce60" style="width:700px;height:600px;"></div>
<script type="application/json" data-for="htmlwidget-5df96d0d69485213ce60">{"x":{"X":[[0.958263740409166,-1.59261620685373,0.675175139214844,0.491498785559088],[0.935783310327679,-2.91759016063343,-0.893390266690403,0.831361855380237],[0.558700437657535,-0.961850600767206,0.736703644040972,0.0279209455475211],[0.675914373714477,-1.96109266116818,0.0751776196993887,0.422010243404657],[1.65256226854399,-5.42485726944496,0.0629175258800387,0.643339199014008],[0.36498637823388,-2.20365712091892,0.450984939932823,-0.491647697985172],[0.862196573521942,-1.31708682502384,-0.763561528176069,-0.76548869907856],[0.868121394421905,-1.50281615947406,-0.912821360863745,0.712143057957292],[1.09936244646087,-3.52874886153211,-0.569412315730006,-0.592767939902842],[1.42900015134364,-5.28084668530073,-0.496587563771755,-0.213644024450332],[0.613193213939667,-0.583894143629239,-0.766684689559042,-0.791198697406799],[1.54015146708116,-4.57278303090252,-0.0822675218805671,0.609893273096532],[0.44376034848392,-0.404897055172333,0.720129202120006,-0.0141956168226898],[0.880574845243245,-0.747680099154672,0.506546959280968,0.985460596624762],[0.172502321191132,-1.96378371032774,-0.248075603041798,-0.314511576201767],[0.955653154756874,-1.48569263029593,0.291484947316349,0.014754808973521],[0.837041962891817,-1.34445129878563,0.676441708113998,-0.739442126825452],[0.998874110169709,-2.36177651459152,-0.918269948568195,0.317746940068901],[1.11040446907282,-0.968183010307857,0.381455207709223,-0.233801576774567],[0.720332825090736,-2.49778740313601,-0.0253176530823112,-0.903649256099015],[1.82742188544944,-7.50406511726578,-0.366549759171903,0.314084128476679],[0.538332925178111,-0.212079981543416,0.542122663930058,0.393863517791033],[1.3187099955976,-4.90307197165186,-0.156287196557969,0.622410059906542],[1.29177385615185,-4.17046932911807,-0.0425707562826574,0.850343320518732],[1.02567282086238,-2.11704239326569,0.974297171924263,-0.988314389251173],[1.34409806970507,-3.24595296440252,0.867628485430032,0.463386270683259],[0.292411941103637,-0.615035990488519,0.511689184233546,-0.00763860577717423],[0.803773017600179,-2.52456969622274,-0.345402158796787,-0.803384813014418],[1.32574843568727,-2.3797050370581,0.126823447644711,0.063116084318608],[0.750458098482341,-2.00813822180525,-0.214997317641973,0.130889976862818],[0.521900252904743,-0.827242003599638,0.369636893738061,-0.160533708054572],[0.756546250078827,-0.17018853117086,-0.906429927330464,-0.594563882332295],[1.66614708397537,-6.53386690638492,0.726510631386191,-0.395245463121682],[0.852725972421467,-2.7771173645497,-0.209218570962548,0.795674158725888],[0.910643229726702,-3.06658686082901,-0.0109377400949597,0.199271863792092],[0.09025366185233,-2.34275844552337,-0.245567207224667,0.815604191273451],[0.512085729744285,-0.904648295283596,0.590551405679435,0.396490001119673],[1.93090122332796,-9.33331743034427,-0.750274527817965,-0.797682791482657],[0.0526449419558048,-2.35375993661208,-0.758605564013124,0.747530170250684],[1.70923090586439,-6.05307130442901,0.413085803389549,-0.515056747477502],[0.717953503131866,-1.61519920065536,-0.76672970270738,0.116737000644207],[0.132458893582225,-2.17252560565819,-0.520086771808565,0.605052903294563],[0.425155147910118,-0.0827845321935953,-0.409217670094222,-0.987999794539064],[1.6604608502239,-6.99676274483201,-0.130494024138898,-0.215956795495003],[0.319736954756081,-1.08969278063289,0.211067623458803,-0.809675507713109],[1.39020669087768,-3.27737445066099,0.706943597178906,-0.496721459552646],[0.443086567800492,0.0613671026181281,0.558819234371185,-0.883365598507226],[1.56817095214501,-5.57834538410792,0.437082006596029,0.0678050997667015],[0.306169074494392,-2.26961841496993,-0.472161790821701,-0.0273321410641074],[1.20596670778468,-4.26578371577313,-0.0629605362191796,0.919901099987328],[0.236325683537871,-1.73551153125193,0.226598735433072,0.329060688149184],[1.11034220457077,-1.21080541434757,-0.323460523039103,0.678476789500564],[1.68755049491301,-5.67964025452846,-0.579296225681901,-0.498628573492169],[1.99057715665549,-9.23410583831718,-0.953008508309722,0.0698630339466035],[1.7710522483103,-5.92476872617516,-0.308492443524301,-0.448938655201346],[1.4120786646381,-4.18855482105459,0.776692690327764,-0.462050199508667],[0.697220715228468,-0.350594273779628,-0.635306998621672,0.687060337513685],[1.21101869177073,-1.6735259748558,0.357818636111915,-0.988693145103753],[0.420174276921898,-0.633151701966661,-0.124888503924012,-0.871158676687628],[0.99086954491213,-3.55395697124441,0.0351879927329719,-0.993718062527478],[0.120584098156542,-1.67299613087451,-0.305636353325099,0.962587331887335],[0.167416303884238,-0.849969996619854,0.502966148313135,-0.5045590181835],[0.173983074259013,-0.836058608407519,-0.405407795216888,-0.872027122415602],[0.796703204046935,-2.48454208297407,-0.950224482920021,0.895828941836953],[1.19380297558382,-3.9935573137916,0.35529774101451,-0.333415571134537],[0.649496882222593,-1.34324745270539,0.568835251964629,0.386662165168673],[1.32657447457314,-4.67897499562092,0.413560014218092,0.137895099353045],[1.86916981404647,-8.81089582470965,0.887199684977531,0.960509988479316],[1.5339536331594,-6.10027945205713,0.91439670836553,-0.0931064230389893],[1.94120742240921,-9.18887406054072,0.0485293595120311,-0.0189073989167809],[0.190657415892929,-2.12087176208462,0.468849859666079,0.188594066072255],[1.17262088088319,-1.55846821763332,-0.121485534124076,0.625014782417566],[1.79265648778528,-7.69443969109878,-0.305880598258227,-0.228997599799186],[0.931668723467737,-2.56545639767859,0.198019463103265,0.124677564483136],[0.142536545637995,-1.8580103985154,0.577326370403171,-0.0403575305826962],[0.773134714458138,-0.886026845676585,-0.609252877999097,-0.137841940391809],[0.682714202441275,-2.95627960576996,-0.694583434145898,0.993918726686388],[1.09226731769741,-2.44751665993811,0.612621690612286,0.771368104964495],[1.87083351472393,-8.89196679844805,-0.819989255163819,0.313167415093631],[1.22544102277607,-2.88285895809416,0.343803024850786,0.47576865227893],[0.899271963629872,-2.55579273067913,0.287739053368568,0.426214975304902],[1.3345042350702,-4.92235684962618,0.124176490586251,0.283625852782279],[0.109262011945248,-0.515216985351985,-0.12576489103958,0.366220064461231],[1.86038062348962,-7.17241618067468,0.537847693543881,-0.607417615130544],[1.02919923886657,-1.10368410435828,-0.587818093132228,-0.272137537132949],[1.89578988170251,-7.92088027041326,0.664761813823134,0.0650437818840146],[0.109257487114519,-1.06310709995197,0.319204895757139,-0.721444295719266],[0.930052620358765,-1.6113979552748,-0.451305749826133,0.176962615456432],[1.79081823769957,-7.32802893124347,0.114870488643646,0.290349773596972],[0.784979226998985,-0.106258840653272,0.646451531443745,-0.966061053331941],[0.987821460235864,-0.713996889276685,0.134818320628256,0.664790701586753],[0.854074070695788,-2.62414045494211,-0.356311860494316,-0.187828892376274],[1.2281901659444,-1.9720660015969,0.203440062701702,-0.852152223698795],[0.539393981918693,-2.99444471890372,-0.841760257724673,-0.698320663534105],[1.46151346201077,-3.71497212460232,-0.231699665077031,0.373870091978461],[0.490435424260795,-0.191125713068902,-0.444555368740112,-0.370943621266633],[0.644288511946797,-1.28547081089282,-0.530491370242089,-0.919786235317588],[1.39705099025741,-3.04534572235971,0.998388338368386,0.399581033270806],[1.83265474392101,-8.50799160222967,-0.117402269970626,0.590806966647506],[1.65075934119523,-6.96050370767692,-0.319251009263098,0.715445001143962],[1.29102932056412,-3.04827317019664,-0.488171061966568,0.264614654704928],[0.892916886601597,-1.36425025809049,-0.79020174080506,0.131623134016991],[1.57054189126939,-4.61312046688553,0.410735168959945,0.382859434001148],[1.4485896169208,-5.20274380343308,-0.436495516449213,0.526218089740723],[1.79174134880304,-5.89573045033543,0.836377655155957,0.369004729669541],[0.282876766752452,-1.6502209344432,-0.564797968138009,-0.386823561508209],[1.74371076514944,-6.20646088729942,0.237358287908137,-0.586317976005375],[0.0439571677707136,-2.17872733543084,0.184657099656761,0.804823933634907],[1.5542473802343,-5.61787607202293,0.89096330339089,-0.98845608253032],[0.431933166924864,-2.09516568559389,0.215777279809117,0.541322475299239],[0.748627376742661,-2.6733653714003,0.981637993361801,0.136953289154917],[0.659439523238689,-2.57942221233511,-0.575970930047333,-0.245148498099297],[1.9158923770301,-7.31121597170992,0.00689014513045549,0.272002127021551],[1.81198194250464,-8.27973925869778,0.226322033908218,0.395106794312596],[0.757259695325047,-2.05136868534823,-0.0597207038663328,0.222485010046512],[0.0751116233877838,-2.41717830779193,-0.56875914009288,-0.138265004381537],[1.28814764460549,-4.58012910489968,0.0930921249091625,0.411744407378137],[0.561790318228304,-3.04445122498595,0.763693773653358,-0.959194607101381],[0.952642704825848,-2.64737755833294,0.244905343744904,-0.986667123157531],[1.37202249187976,-3.79411196796896,0.897187447641045,0.189464251045138],[0.195847682189196,-1.6117153452261,0.682573451194912,-0.908301159273833],[0.572608445305377,-0.285704880947584,-0.189902591984719,-0.32104954496026],[0.31256381701678,-0.476472654913143,0.222451291047037,-0.594029846601188],[1.67798185348511,-6.60050104340537,0.782544312998652,-0.757289662025869],[1.4748885226436,-5.99256088426514,-0.00663073640316725,-0.968465177342296],[1.35954136773944,-5.23631565743719,0.375559976324439,0.427613035775721],[0.502705173101276,-0.681328819513487,-0.610183109529316,0.800159309525043],[0.0439869593828917,-0.459663429947135,0.408332565799356,-0.0694483248516917],[0.973770346026868,-1.24001600940834,0.642258956097066,-0.378978053107858],[0.290646863635629,-0.63897234704405,-0.0148125169798732,0.427769960369915],[1.79310716781765,-6.8238877309412,0.758783655241132,-0.0687172506004572],[1.21351986052468,-3.4278022630075,0.772936553228647,-0.508025269955397],[1.84936930658296,-7.08630500796624,-0.68858615681529,0.167759255506098],[0.384922375902534,-1.75209201137587,-0.730274027679116,0.29542030300945],[1.6953621674329,-5.93283424549397,-0.647375092841685,-0.648838463239372],[0.0783311920240521,-1.38672880465989,0.348505584988743,-0.152893727645278],[1.15533814579248,-4.01544370518824,0.502862143795937,0.247298631351441],[1.45317914802581,-3.85341960377407,-0.786481900606304,-0.302433325443417],[0.373420455958694,-1.59527074530378,0.298755762632936,0.849608556367457],[0.284896734636277,-1.7791563769321,-0.392831891775131,0.751052918378264],[0.59881076682359,-2.70116620799184,-0.28073563799262,-0.452576183713973],[0.54689182434231,0.148452376974673,0.724220125935972,-0.102128347381949],[0.688313990831375,-2.12003039934318,0.855997390579432,0.306548972148448],[1.97825999325141,-7.65139564221468,-0.0215017017908394,0.796306986827403],[1.6347822509706,-6.16966422754435,-0.0218207570724189,0.906828122679144],[0.690502623096108,-1.5629542725619,-0.665299820248038,0.539621475618333],[1.49142066016793,-3.6880769667908,0.347373963333666,-0.905658837407827],[1.50298336427659,-5.30319596406141,-0.997434431221336,-0.710573195945472],[0.760624896734953,-1.71030015900461,0.165662776213139,0.701888831332326],[0.59917709371075,-2.98596431424209,-0.651237805839628,-0.0321204396896064],[1.17904324736446,-2.4180124540414,-0.0850553438067436,0.339166821911931],[1.77731408877298,-6.53230600129138,-0.288812875282019,0.123434889595956],[0.536705825012177,-1.31206870009771,0.701235551852733,-0.435267290566117],[1.11776905506849,-4.21589584062229,0.496124125085771,0.0807167757302523],[0.441597849596292,0.0565515001720689,0.401441156864166,0.322599241510034],[0.664701846428216,-0.482029066922455,-0.991765290498734,-0.751789959147573],[1.90097646927461,-9.16681162745074,-0.156527930404991,0.105672390200198],[1.70441391225904,-5.83852833630972,-0.533396399579942,-0.492915076669306],[1.88744332734495,-7.2104897986333,0.457564455922693,-0.994526534806937],[1.63579176645726,-5.43143988287551,-0.411752003245056,0.489200757816434],[1.56638758163899,-4.08372289680989,0.971331690903753,-0.981007052585483],[0.863571560010314,-1.75192804763655,0.926667318213731,0.723632930777967],[1.21784504828975,-3.07065517499541,-0.0232577952556312,0.896237713284791],[1.1751928399317,-1.31298165387216,-0.0252115400508046,0.414789386093616],[0.261685790959746,-2.23117463625822,-0.470092872623354,0.76808880828321],[1.35425768466666,-3.66625837587702,-0.170581544749439,-0.165932825766504],[1.86811839649454,-7.13749909842554,-0.344150440767407,-0.218583969399333],[0.134650379884988,-0.1358268054292,0.504072980489582,0.99050628207624],[0.0586112798191607,0.19492083608752,-0.706483010202646,-0.797723525669426],[1.93094134703279,-7.97416464507227,-0.180154018569738,0.204308797605336],[1.20467370841652,-2.80961728689792,0.335795227903873,0.125534905586392],[0.990309292450547,-1.96409275978303,-0.594473607372493,-0.183293361216784],[1.07943827426061,-2.8974371975549,0.0359750692732632,-0.539630551822484],[0.415342014282942,-2.11654049483475,0.374278725590557,-0.208123819436878],[1.56675246171653,-5.8453017841633,0.93335724901408,0.62385472189635],[1.35635792836547,-2.94874572902856,-0.873632651288062,0.98352660657838],[0.996423394884914,-2.6073909258708,-0.998546368442476,-0.707406057976186],[1.72248605731875,-5.882996800814,0.615621698554605,0.42801673989743],[0.668435646221042,-2.53052619688446,0.559341853950173,0.456345974467695],[1.40916598169133,-2.89818550490984,-0.664175095502287,0.597589388955384],[1.71437862981111,-7.25968035348235,0.263766418676823,0.606048638001084],[0.767664086539298,-1.59929791981233,0.958418613765389,0.602281448431313],[0.103681984357536,-2.34774741724399,-0.193020247854292,0.590231595560908],[0.178309767041355,-0.531671508452416,-0.680221064016223,-0.491056237369776],[0.32612845255062,-1.66643644285498,-0.61769751412794,-0.107045873999596],[0.783166603185236,-2.6704448883726,0.362094815820456,0.842862020712346],[0.772499545942992,-1.32831186108734,0.995407444890589,-0.346552673261613],[0.433778541628271,-1.01187884350545,0.128895848058164,-0.100216118153185],[0.980402359273285,-3.13596056911764,0.39502760162577,-0.0439629419706762],[0.669791161082685,-1.01706644712099,0.623166944365948,0.350027155131102],[0.680450581945479,-1.27956145807525,-0.989113478455693,-0.0746099515818059],[1.55538963060826,-5.41757228589506,-0.4683036073111,0.026060982607305],[1.24767211545259,-2.69119795840744,0.650477648247033,-0.726141239050776],[1.05615853145719,-1.83781272807121,-0.291928452439606,0.00730710057541728],[1.12638588435948,-2.15850952395393,-0.371091665234417,-0.567595685832202],[1.39181923866272,-5.08300451245607,-0.988570635206997,-0.19255941035226],[1.81773419398814,-8.45310729748574,-0.869685084093362,-0.632195488084108],[1.07270642695948,-2.92739929544485,-0.726858346257359,-0.559741340577602],[0.397779170423746,-1.87550438970217,-0.874408273026347,-0.40828055748716],[0.10835598828271,-1.85078859985478,0.173658896237612,0.628265285398811],[0.745872532948852,-1.87278250493963,-0.734022964257747,-0.937162063084543],[1.66259455261752,-6.50596414241241,0.914495452307165,-0.156019616406411],[1.80168845737353,-6.78717942925151,0.224882110022008,-0.742625875398517],[0.164127828087658,-1.48442141196747,-0.446373358834535,0.772371630650014],[0.295255695469677,-0.931095814599249,0.359627748373896,0.0252307285554707],[0.0518005094490945,-1.96516603487226,-0.65816539991647,0.411322634667158],[1.04795508645475,-1.72459581157569,0.948248863220215,0.248349608853459],[0.946856180205941,-0.979436259619096,0.131663176696748,0.618400686886162],[0.789546263869852,-1.49732797328473,0.631196590606123,0.475086946971714],[1.17388477781788,-2.73534333859507,-0.872338925953954,-0.337472883053124],[0.168895301874727,-1.09852643780379,-0.871910349931568,-0.767885773442686],[1.37682552589104,-3.9544080297032,0.935928856022656,-0.164186567999423],[1.78474578168243,-5.86323486520386,0.96970531437546,-0.528850468806922],[1.42733792029321,-3.9134940956131,-0.697160666342825,-0.233488345518708],[1.84576962282881,-7.59038061916832,-0.20338540757075,-0.986917322967201],[1.88968541892245,-6.97214281336071,-0.59752157703042,0.693982692435384],[1.51057249074802,-5.55227231397394,0.182995828799903,0.854830345604569],[0.634805429261178,-2.02273068401157,0.973184379749,0.872949310112745],[1.06520304782316,-0.953567043293308,0.691332966089249,-0.452403119299561],[1.42242833971977,-2.93193414217343,0.461179010104388,0.552924270741642],[0.184521895833313,-2.29903188198333,0.241873068269342,-0.264151646289974],[1.50027542375028,-3.43421555199398,0.431579406373203,-0.283659717533737],[1.05942273372784,-2.61706476159493,0.619432571809739,0.200949999969453],[0.965538556687534,-1.11608626430735,0.385609166231006,0.396239026915282],[1.94583375751972,-7.43693407620169,0.193886873777956,0.0114012854173779],[0.0129762105643749,-0.378230771244327,-0.978641229216009,0.136957740876824],[0.953021234832704,-1.8568792722883,-0.395525260362774,0.24321596045047],[1.84518407005817,-7.761431601777,0.585866378620267,-0.90727508906275],[0.812657643575221,-0.809148508842372,0.789754590950906,0.76509019639343],[0.704387510661036,-1.63699231537661,-0.0362523393705487,-0.537050575949252],[0.644896038342267,-0.763676660057139,-0.983426827937365,0.727247620001435],[0.123692439403385,-1.72208690989481,-0.320830613840371,-0.88653062377125],[1.21856924565509,-3.36882080633213,0.334547792095691,-0.00687413010746241],[0.803158492315561,-1.10210171066513,0.779019340872765,0.309294633567333],[0.55094906128943,-0.938736698366104,0.32406196417287,0.315556609071791],[0.0296862861141562,-0.971384640566907,0.972022044938058,0.813012458849698],[1.94280271511525,-7.62118616320558,-0.67161121359095,0.0700739212334156],[1.09055027319118,-2.13404539437213,-0.832978375256062,0.0534144537523389],[1.59154723072425,-5.95383010433348,-0.813627648632973,0.761107108555734],[1.02642627991736,-1.17770777293024,0.110580944921821,-0.928114638198167],[0.182517520617694,-0.131223685946887,-0.562513258773834,-0.222362168133259],[0.0976645727641881,-2.7895106824088,0.416388680227101,-0.805811478756368],[0.716165954712778,-2.78068543274081,0.630370704457164,0.879499901086092],[0.884990971069783,-2.72819564024435,-0.6135787172243,0.563924478366971],[1.83167894883081,-6.30455451534703,-0.32174356514588,-0.96519961534068],[1.01009900262579,-0.85534984875962,-0.0272232950665057,-0.643803681712598],[1.71561341639608,-7.03609562217113,0.593178589362651,-0.229825188405812],[1.21020317217335,-3.03882416379928,0.0791790685616434,-0.402938097715378],[1.83718873839825,-7.49864645232546,0.796171325258911,0.718365485779941],[1.18724301503971,-2.22404786871599,0.74498934391886,0.646157917100936],[0.761883377563208,-1.37576530683834,0.56541039980948,0.556786810979247],[1.25464904028922,-4.30204172067345,0.516012082342058,-0.218199661001563],[1.09996370133013,-1.7348402072309,-0.7008789149113,-0.484854891430587],[0.113458401989192,-2.23808094415322,0.49537279875949,-0.110853917431086],[1.68871495453641,-5.25424462053081,-0.12101096380502,0.247650639154017],[0.0472772987559438,-2.38455350283358,-0.354791119229048,0.998028824105859],[1.751855537761,-7.46371624444815,-0.224152719136328,0.307748461607844],[0.524691712111235,-2.57899436001918,0.0288242939859629,0.988599029835314],[0.596128503791988,-1.56963886733147,0.535983241163194,0.389682105742395],[0.835236934944987,-2.77856327189835,-0.256065899971873,-0.926020501647145],[0.362958751618862,-0.0296076508832401,-0.642527603078634,0.656912306789309],[1.91958772111684,-7.45681083890047,0.120695971883833,-0.764409948606044],[0.435439682099968,-1.12600650092052,0.355571653228253,-0.444902973249555],[1.44059555418789,-4.78328992448181,0.886299627367407,0.380957644432783],[0.805031572468579,-3.20551303685635,-0.197284321766347,0.0335160358808935],[1.41030892590061,-3.2776313907363,-0.01642922218889,-0.612973761744797],[0.25943572120741,-1.77192670301646,0.199004845693707,-0.30705037061125],[1.06360976677388,-3.20130260530368,-0.808746576774865,0.510681241285056],[0.788568556308746,-0.325385618303196,0.869304697029293,0.170013325754553],[1.18232338037342,-3.85539528194576,0.122432629577816,0.52181396773085],[0.716549045406282,-2.89861094459456,0.450597472954541,-0.466617127880454],[0.987114833202213,-2.9686069396928,-0.101901932619512,0.332607157994062],[1.40120709920302,-2.92692869329016,-0.897671199869365,-0.373400176409632],[0.135148623026907,-1.64776137968228,0.0324889067560434,0.949982610996813],[1.93898579152301,-8.7957106779702,0.538982023950666,0.616092452313751],[0.851818375755101,-2.22027661588505,0.362479140982032,0.0311730890534818],[1.98838381236419,-9.7275482580013,-0.386948589701205,0.242627383675426],[1.96346480026841,-9.52629088048424,-0.88002418121323,-0.947864133864641],[1.20221730601043,-3.22574924717027,-0.0150364791043103,-0.101354522164911],[1.75348550500348,-6.61444093116423,-0.13318289257586,0.932670437265188],[1.58139051496983,-4.43255139232006,-0.811444898601621,-0.843730266671628],[0.525399215053767,-1.89258381180455,-0.388304070569575,-0.514787669759244],[0.499031770974398,-1.71041317719258,0.660395671147853,-0.216742624994367],[1.2895214795135,-3.52994796664207,-0.966879863291979,0.621542889624834],[0.69247867539525,-0.886981559040857,-0.876122367568314,0.21452109888196],[0.240937712602317,-1.48433943350618,0.962622133083642,-0.411165382713079],[0.928545436821878,-3.10515736275192,-0.981425545178354,0.65461552888155],[0.449535493273288,-0.218530602042357,-0.367727884557098,0.344016095157713],[1.25306230923161,-3.48709310067485,-0.765276050195098,-0.407545401714742],[1.89035491412506,-8.27735945741499,-0.0719177252613008,-0.876959456130862],[1.16341746132821,-2.72459245711437,-0.598841610830277,0.821039880160242],[1.45473533449695,-4.97129820301706,-0.523872086778283,-0.159264800138772],[0.439245620276779,-2.35145122351071,0.542340812273324,-0.93529301835224],[1.86725110420957,-8.07244418044196,0.240486253518611,-0.566287402994931],[1.60564819583669,-6.42226746522248,0.713946123141795,0.533620856702328],[1.72987185278907,-7.39150731813503,0.275428028777242,0.128938273061067],[1.51135042589158,-4.69693956007158,0.513857373036444,-0.629504799842834],[1.35013455478474,-2.86857716087551,0.906950096134096,-0.678392603993416],[1.13298018602654,-2.04314105645464,0.0563024636358023,0.403896057978272],[1.7722829664126,-6.67822209767881,-0.496312232222408,0.157578228507191],[1.29298177547753,-4.56262777688102,0.865809326525778,-0.652246624231339],[0.295687663834542,-1.476317715654,0.782782087568194,-0.710992421489209],[0.637467769440264,-0.279886080386251,0.594402044080198,0.000132745131850243],[0.979928471613675,-1.04029546548032,0.497108359821141,0.710947384126484],[0.825946694239974,-2.7086762273445,-0.966169302351773,0.715139773674309],[1.49361183587462,-4.65759363731748,-0.750837490428239,-0.369783130008727],[1.85456337407231,-7.11881189013795,0.498945996630937,0.531077024526894],[1.18133924622089,-1.37701244038129,-0.0298075191676617,0.188049284741282],[0.249800814781338,-0.613984280415433,-0.705355535261333,-0.124502542894334],[1.15775696001947,-4.17538242181878,0.338085514958948,-0.320523142348975],[1.218404030893,-2.34723660883633,-0.611734428443015,-0.507875618990511],[0.252151036635041,-0.751296231225991,-0.633891964331269,0.493589659687132],[1.22732530906796,-4.37360487878224,0.838724434375763,0.409230518620461],[1.47743631526828,-4.45399678099959,-0.260532918851823,0.131476255133748],[0.822666991502047,-2.68209104973966,-0.349573427345604,-0.117816019803286],[0.683196539990604,-3.04185345333402,0.808460974600166,-0.757159735076129],[1.22180720884353,-1.4624505447704,0.958392254076898,0.318609971553087],[0.220399047248065,-1.65538960845858,-0.389891915954649,-0.649497949518263],[1.90096143214032,-8.77140947796736,-0.779254911467433,-0.580374802462757],[0.635747974738479,-2.78997555672736,-0.197280543856323,0.0157693000510335],[1.33690366474912,-3.62869316231901,0.918476363644004,-0.632463315501809],[1.70981584861875,-7.02661276730877,-0.623753875028342,-0.0474593038670719],[1.11334594013169,-3.08498360091008,0.537399719003588,-0.406756192911416],[0.715018522460014,-0.818996857648463,0.0941199366934597,0.341945198364556],[0.429874451365322,-0.791755532090177,-0.416817876975983,0.711164311040193],[1.21434025699273,-4.16443039650732,0.285445395391434,0.776582961436361],[0.4394312039949,-2.63394549785775,0.487954899668694,0.0781070627272129],[1.27063705958426,-4.65636893242137,0.0513175195083022,0.692612513434142],[1.94998997123912,-7.67188564954,-0.647493736352772,-0.911846760194749],[0.17982432898134,-2.83262165945404,0.918863690458238,0.845042777713388],[0.76213355595246,-2.82408941055713,0.47937984066084,0.758724886458367],[1.38688905304298,-4.4957292645331,0.768523800652474,0.0525216897949576],[1.59433595929295,-5.0044972325376,0.906588697340339,-0.875756747554988],[0.771308640018106,-2.09453222290482,-0.87115736445412,-0.215648071840405],[0.167735903989524,0.001020282461103,0.949074658099562,-0.109976130072027],[0.866874385159463,-2.38746609836911,-0.512997183948755,-0.0408645081333816],[0.497015441767871,-1.05205563921832,0.846529737580568,-0.206518694758415],[1.47354511171579,-3.15294776273677,0.623863299842924,0.570462096016854],[0.5993408607319,-0.17602997817986,0.193309541791677,0.920144995674491],[1.39259469276294,-2.96703360683,0.348252926487476,-0.310007798485458],[1.46257224446163,-3.66619995860827,0.0793764446862042,0.472969020251185],[0.53583922656253,-0.318892613143437,0.81380835454911,-0.502556281164289],[0.843260887544602,-1.92057010886029,0.978773180395365,-0.958987492602319],[1.43637576792389,-4.52467108929231,0.841226223856211,-0.354751516599208],[1.16691664047539,-4.06748509908187,0.689685716293752,0.490099794231355],[0.692592799663544,-0.791373534919026,0.0609827470034361,0.222742368001491],[0.0807359525933862,-2.68847156674698,0.306583830621094,-0.235921976622194],[1.89137342758477,-7.05768783724065,-0.64369493117556,-0.8464535465464],[0.94859371194616,-2.47557580103193,-0.688558119349182,0.134003280662],[0.622207730542868,-0.811471031519329,-0.548903668299317,-0.535842725075781],[0.318560759536922,-2.82922402464022,-0.307361775543541,0.165088087785989],[0.903649487998337,-2.68854126722809,0.138414821587503,-0.638365101534873],[0.979834403377026,-2.99977069805252,0.775655139237642,-0.146714537870139],[0.779012836050242,-1.05513327608708,-0.838793222326785,0.931112617254257],[0.3326560058631,-2.66651466258692,-0.255297172814608,-0.59774441504851],[0.688207414001226,-1.36159205340491,-0.0183906215243042,-0.963759853038937],[0.828454417642206,-0.572244208566737,0.537081524729729,0.911902052816004],[0.895183185581118,-3.14940150442822,0.848861352074891,-0.439334621187299],[0.489767625462264,-2.40773589543847,-0.653039540629834,-0.918836206197739],[0.511146859731525,-1.15594803894781,0.464925225358456,-0.984180259518325],[1.26484018797055,-1.81849705402609,-0.332682771142572,0.143807549029589],[0.915841088630259,-1.29652308580372,-0.149339050985873,-0.708131053484976],[0.244422227609903,-0.190490393633172,-0.790242639835924,-0.178052759729326],[0.733520550653338,-1.60728758185292,0.17499500606209,-0.0784068931825459],[1.2343624564819,-3.84266390710332,-0.72005550051108,0.155877300072461],[0.155315535143018,-1.54583523487719,0.733869799412787,-0.0417203423567116],[1.4384239432402,-3.97602757650533,-0.590851870365441,-0.246868707705289],[0.60239491192624,-1.87079204558744,0.0254791737534106,0.774240043479949],[0.459568701684475,0.00400918333791134,-0.412670482881367,-0.0367749538272619],[1.86481015523896,-8.09195873764595,-0.380315814632922,-0.538768318481743],[0.684626081027091,-2.41846210335154,-0.511191561818123,-0.455756797455251],[0.683196988888085,-2.60466823447997,0.340413173660636,-0.41523179737851],[1.11428519804031,-3.65335049441188,0.461871111299843,-0.163922353647649],[0.25420715007931,-0.167506128464453,-0.447967641521245,0.706089140847325],[1.58648990420625,-6.8950767410042,-0.6985724712722,0.924650028347969],[1.15545445913449,-3.78212404344834,0.523254925850779,0.725054062902927],[0.259412728250027,-0.863612589695758,-0.893435254693031,-0.27206269139424],[1.4598594494164,-2.88099190868003,-0.259139037691057,-0.638171531260014],[1.44795521488413,-2.82062448362199,0.470265096519142,0.106483738403767],[1.83379657473415,-6.85626026502321,0.582811904605478,-0.0227877241559327],[0.740040122065693,-0.556332120686361,0.506887145340443,-0.651099986862391],[0.954650470986962,-3.17118738380065,-0.965940781403333,0.883625266607851],[0.469328804407269,-0.190756012653077,0.180930252652615,0.400477048475295],[1.4575607101433,-3.20264266168463,-0.47046477580443,0.180952246300876],[1.5872854446061,-5.8987828599001,0.12138052796945,-0.760973356664181],[0.29577185260132,-2.72788784954648,-0.0789270848035812,-0.530271616298705],[1.69323341501877,-6.97924129828032,-0.676427924074233,0.486296236049384],[0.541072928346694,-2.39516720054786,-0.225624500773847,0.482999719679356],[1.49471956398338,-2.92116847629646,0.389475697185844,0.289575959090143],[1.39048578497022,-2.64777398831085,-0.774352737236768,-0.0245955628342927],[0.848365153186023,-1.91106240137733,-0.201207765378058,-0.416235466953367],[0.0333929122425616,-0.447499047115718,-0.590835233218968,0.277626946102828],[0.370495524723083,-1.48792284924556,0.175611582584679,-0.237536537460983],[1.79202716425061,-7.24574281517371,0.770444296766073,0.470472213346511],[1.39677196461707,-3.27602216040338,-0.457174341659993,0.408278085291386],[0.517766568344086,-1.84720640945921,-0.638013239949942,-0.576422272250056],[1.78977319411933,-5.43742574571347,-0.708520742598921,-0.715398234780878],[0.0195836992934346,-1.80763268342514,0.277222161646932,-0.555672222282737],[0.227225271053612,-0.690112837651036,0.25467820558697,0.888553932774812],[0.24130091490224,-1.8142931868316,0.904221029952168,-0.274858333636075],[1.98437136411667,-8.97724200189125,0.553536199964583,0.234739562962204],[1.76221501082182,-5.79366583203431,0.996338557451963,0.433606687933207],[0.0244002756662667,-2.23837131440567,-0.838348030112684,0.240182057023048],[0.146406519692391,-2.58323715592342,0.908587563317269,0.913570005912334],[0.0785412071272731,-1.20528989088428,-0.154583143536001,-0.806260465178639],[0.28484907746315,-0.86550198984488,-0.529532287735492,-0.788579846732318],[1.65295656444505,-6.77023063560661,0.175131808035076,0.55537358764559],[1.02784847328439,-2.07752551868123,0.560008525848389,0.921656594611704],[1.47931037656963,-5.22220086775804,0.325486784800887,0.190044501796365],[1.5942594925873,-4.63531398961689,-0.756553587503731,-0.489890974480659],[1.02100197365507,-1.29089606617707,-0.0768780428916216,-0.928381432313472],[1.54453000426292,-6.03982990739048,-0.114350820425898,0.895719050895423],[0.292595675215125,-2.08975807677859,0.916661014314741,-0.191889273934066],[1.21339809987694,-2.59751320221738,0.698409788310528,-0.0156731377355754],[0.385466837324202,-1.63564666504832,0.393269235268235,0.549881190061569],[0.496098017785698,-2.27226778705391,0.620982669759542,-0.0356279872357845],[1.18547442555428,-2.73568063726109,0.201218262314796,0.0226436187513173],[0.542504050768912,-2.42272285511506,0.812181320972741,0.295456382445991],[1.27398384548724,-4.58524890765976,-0.656935962382704,-0.309086642693728],[0.956851087976247,-1.17797464143596,-0.383574468549341,-0.873079780489206],[1.01264121662825,-3.33156879224607,-0.484038162510842,0.659499131143093],[0.280890536494553,-2.29196665218246,-0.349194509908557,-0.388224569149315],[1.21400219015777,-1.75523772659139,-0.0792007525451481,0.273622133303434],[0.871801456436515,-3.37994039448318,0.890898165293038,-0.463795819785446],[0.613351166713983,-0.549569625256362,0.311142384074628,-0.149503393564373],[0.616222134791315,-2.52790490581875,0.866068759933114,-0.294247047509998],[1.87880532024428,-9.11029584253502,-0.615352323744446,0.338792365044355],[0.413320640102029,0.047006209831933,-0.0778515483252704,-0.0988392285071313],[0.76610728027299,-2.77373725997472,0.525274709332734,-0.268841050565243],[1.04408621089533,-1.88689645778889,0.868424915708601,0.405749607365578],[1.83466012449935,-6.07085923960097,0.483483638148755,-0.703095606993884],[0.448318224400282,-0.835031731026447,0.549871875438839,0.939237290993333],[1.1211299020797,-1.8775505206493,0.00615099910646677,0.756562448572367],[0.726099031511694,-1.63230430374001,-0.973729690536857,0.0732147763483226],[1.65998428408056,-6.83088937082729,0.211612151470035,0.637702394276857],[0.577903142664582,-2.63901406238438,0.175212210509926,-0.931727096904069],[1.31973228277639,-2.20889841806434,-0.597893634811044,0.383571070153266],[0.93313169432804,-2.89318279542402,-0.674851623829454,0.957944652531296],[1.3522691144608,-2.76932260684641,0.872208924032748,-0.0952911642380059],[1.24140963610262,-3.02380855097735,0.544526801910251,-0.0567008634097874],[0.62625617813319,-1.05650534822553,-0.450086482334882,-0.96822746982798],[1.50878740241751,-5.23895041304806,-0.721110014244914,0.711140168830752],[0.143788866698742,-0.885858699893691,0.289467048831284,-0.474945693276823],[1.6062402385287,-5.45919994313246,0.596456284634769,0.0556264952756464],[1.60787532944232,-3.99234146168906,-0.715189221315086,0.0918818614445627],[1.6305245696567,-6.39718408047889,-0.234213408548385,-0.338450562674552],[1.19594292901456,-2.67319050730386,0.967637262772769,0.453795929439366],[1.86895712744445,-7.3284815098855,0.430868851486593,0.241495649330318],[1.3312555202283,-3.2238766273057,0.9610884655267,0.623185857199132],[1.30837618978694,-4.71352522473037,0.262673233170062,-0.405007441528141],[1.84202165994793,-8.60085271476305,0.429826128296554,-0.776632396504283],[0.622523240745068,-2.54621763083783,-0.364685972686857,-0.98725952534005],[1.33864353457466,-4.87489750605346,0.324726949911565,-0.60707432962954],[1.95651026815176,-8.68269291198373,-0.218665180727839,-0.129292856901884],[1.25220535602421,-4.13001792342431,0.647371398285031,-0.407628580927849],[1.2914279140532,-2.13506347205308,0.636005364824086,-0.125726559199393],[1.69279687060043,-7.37928459733158,0.82908264733851,0.414464123547077],[0.963487647473812,-1.36154498409947,-0.00401064986363053,0.921461589168757],[1.06837004981935,-3.67897643757892,-0.591389595996588,-0.959105056710541],[1.63355989474803,-4.28992464140101,-0.311842061579227,-0.433727700728923],[0.0187177611514926,-0.70693772408782,0.259588403161615,-0.688511421903968],[0.677819954697043,-0.471785814378906,-0.0246283616870642,-0.52845181664452],[1.62770633166656,-4.36640507935397,0.141422313638031,0.527343655470759],[1.09492219798267,-3.13222173593564,0.325226594228297,0.672943732701242],[1.50456851487979,-3.26982779732292,0.922928860876709,-0.488453549798578],[0.774458140134811,-1.70641442745464,0.341270483098924,0.697219504509121],[0.358965526800603,-0.0528459349397792,0.667657478712499,-0.75325244339183],[1.32768981950358,-2.45595713805081,0.459043900016695,0.568570160772651],[0.663926123641431,-2.83250377433917,0.406468165572733,0.302962535060942],[0.121718684211373,-0.168262499886243,0.584840460214764,0.12563116941601],[1.25133038451895,-2.19195513761207,-0.384230663068593,-0.71438816562295],[1.78729272680357,-6.72908838212731,-0.10780240315944,0.828315293416381],[1.35985392611474,-3.13616396325478,-0.303032859228551,-0.0841315151192248],[0.23553588707,-1.68439471753753,0.952365274075419,-0.615784331224859],[0.683382397051901,-0.995795031532708,-0.653352179098874,-0.0664363079704344],[1.40866528637707,-4.90179401525099,-0.931639730464667,0.51284601772204],[1.60082437004894,-4.50377223854698,-0.438474881462753,0.360445403959602],[1.39373354334384,-5.0762279976184,0.217934161890298,0.287637115456164],[0.445347529370338,-1.94977531773046,-0.980425032321364,-0.279139950871468],[0.701037176884711,-1.18718678092631,-0.279230713378638,-0.500932837370783],[1.66305768676102,-5.81919537003042,0.41908430820331,-0.351436343509704],[1.71665889024734,-7.11035373407646,0.762406791560352,-0.747853459324688],[1.92595880199224,-9.64531766001352,-0.989429572131485,0.161726636812091],[1.50573220662773,-4.94408077591634,-0.340348271653056,-0.323863956145942],[0.5833022557199,-2.29481042602476,-0.712132374756038,-0.45970322843641],[1.11026698676869,-4.00532911676192,0.751222525257617,0.706249295268208],[1.01862491760403,-2.8374329002903,0.403437495231628,0.601887357886881],[0.467302634380758,-1.96846731888426,-0.147610732354224,-0.131415606942028],[1.42650392185897,-5.18710799115586,0.960770003963262,-0.809813023544848],[0.0750600653700531,-0.403971701559538,0.561780192423612,-0.741335034370422],[0.337994790636003,-2.19588870280615,0.189424108713865,0.428207350429147],[0.0206444170325994,-0.928032398154716,-0.735053522512317,0.76770383445546],[0.244076797738671,-1.77366400579401,-0.684303648304194,0.295630191918463],[0.456538945436478,-2.25481205363925,0.465011181775481,-0.633991871960461],[1.54698043409735,-4.43461361230796,0.771803160198033,0.728251278866082],[0.141465626191348,-0.018565374741276,-0.155357243493199,0.644202498253435],[0.991485443431884,-0.78349860983193,-0.183596407528967,0.141188114881516],[0.325744499452412,-1.80826763688368,-0.84849693113938,-0.0575682213529944],[0.91169758560136,-2.46017314674641,-0.622680836822838,0.910647331271321],[1.55219931015745,-4.30461809031766,0.761223984416574,0.23777897330001]],"center":[1.00267998630367,-3.21117067804463,0.0358139380384237,0.000745358301326632],"scale":[5.89692329337425,5.89692329337425,5.89692329337425,5.89692329337425],"colnames":["x1","x2","x3","x4"],"rownames":[],"group":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"levels":[""],"extraAxes":null,"extraAxesNames":[],"lineFrom":[],"lineTo":[],"lineColors":[],"axisColors":[],"levelColors":[],"colorVariation":0.3,"pointSize":1,"crosstalkGroup":null,"crosstalkKey":null,"state":null},"evals":[],"jsHooks":[]}</script>
<p></p><figcaption class="figure-caption">Figure&nbsp;5: Original data of 2D curvilinear in 4D.</figcaption><p></p>
</figure>
</div>
</div>
<p>As shown in <a href="#fig-fig6">Figure&nbsp;6</a>, 2D embedding in PHATE preserves the local structure, while others have misleading results. For example, in TriMAP, 2D curvilinear is not preserved with the default neighborhood value. On the other hand, PaCMAP, UMAP, and t-SNE have the geometry of a 2D curvilinear, although clumpy points mislead the result.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ## tSNE</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># random_num2 &lt;- runif(1, min = 1, max = 10000000)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(random_num2)</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># tSNE_fit &lt;- df_2_n1 %&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   Rtsne(perplexity = 30)</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># tSNE_df &lt;- tSNE_fit$Y %&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   as.data.frame()</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># names(tSNE_df) &lt;- c('embedding_1', 'embedding_2')</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># tSNE_df$type &lt;- rep("tSNE", nrow(df_2_n1))</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ## UMAP</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># random_num2 &lt;- runif(1, min = 1, max = 10000000)</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(random_num2)</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># UMAP_fit &lt;- df_2_n1 %&gt;%</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   umap(n_neighbors = 15)</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># UMAP_df &lt;- UMAP_fit$layout %&gt;%</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   as.data.frame()</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co"># names(UMAP_df) &lt;- c('embedding_1', 'embedding_2')</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co"># UMAP_df$type &lt;- rep("UMAP", nrow(df_2_n1))</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Phate</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co"># random_num2 &lt;- runif(1, min = 1, max = 10000000)</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(random_num2)</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="co"># tree_phate_fit &lt;- phate(df_2_n1, 5)</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="co"># PHATE_df &lt;- as.data.frame(tree_phate_fit$embedding)</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="co"># PHATE_df &lt;- PHATE_df %&gt;% select("PHATE1", "PHATE2")</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="co"># names(PHATE_df) &lt;- c('embedding_1', 'embedding_2')</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="co"># PHATE_df$type &lt;- rep("PHATE", nrow(df_2_n1))</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="co"># ## TriMAP</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="co"># source("functions_tri_hex_TriMAP_without_pc.R", local = TRUE)</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="co"># source_python("Fit_TriMAP_code.py")</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="co"># n_inliers_n &lt;- as.integer(12)</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="co"># n_outliers_n &lt;- as.integer(4)</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="co"># n_random_n &lt;- as.integer(3)</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="co"># tem_dir &lt;- tempdir()</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit_TriMAP_data(df_2_n1, tem_dir)</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="co"># path &lt;- file.path(tem_dir, "df_2_without_class.csv")</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="co"># path2 &lt;- file.path(tem_dir, "dataset_3_TriMAP_values.csv")</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="co"># random_num2 &lt;- runif(1, min = 1, max = 10000000)</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(random_num2)</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit_TriMAP(as.integer(2), n_inliers_n, n_outliers_n, n_random_n, path, path2)</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a><span class="co"># df_TriMAP &lt;- read.csv(path2)</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a><span class="co"># names(df_TriMAP) &lt;- c('embedding_1', 'embedding_2')</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a><span class="co"># df_TriMAP$type &lt;- rep("TriMAP", nrow(df_2_n1))</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a><span class="co"># ## PaCMAP</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a><span class="co"># source("functions_tri_hex_PaCMAP_without_pc.R", local = TRUE)</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a><span class="co"># source_python("Fit_PacMAP_code.py")</span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a><span class="co"># knn_n &lt;- as.integer(10)</span></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a><span class="co"># init_n &lt;- "random"</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a><span class="co"># MN_ratio_n &lt;- 0.5</span></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a><span class="co"># FP_ratio_n &lt;- 2.0</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a><span class="co"># tem_dir &lt;- tempdir()</span></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit_PacMAP_data(df_2_n1, tem_dir)</span></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a><span class="co"># random_num2 &lt;- runif(1, min = 1, max = 10000000)</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(random_num2)</span></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a><span class="co"># path &lt;- file.path(tem_dir, "df_2_without_class.csv")</span></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a><span class="co"># path2 &lt;- file.path(tem_dir, "dataset_3_PaCMAP_values.csv")</span></span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit_PaCMAP(as.integer(2), knn_n, init_n, MN_ratio_n, FP_ratio_n, path, path2)</span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a><span class="co"># df_PaCMAP &lt;- read.csv(path2)</span></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a><span class="co"># names(df_PaCMAP) &lt;- c('embedding_1', 'embedding_2')</span></span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a><span class="co"># df_PaCMAP$type &lt;- rep("PaCMAP", nrow(df_2_n1))</span></span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a><span class="co"># expample_3 &lt;- bind_rows(tSNE_df, UMAP_df, PHATE_df, df_TriMAP, df_PaCMAP)</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a><span class="co"># expample_3</span></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(expample_3, "Example_3.csv")</span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>example_3 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Example_3.csv"</span>)</span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>example_3_with_label <span class="ot">&lt;-</span> example_3 <span class="sc">%&gt;%</span></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> embedding_2)) <span class="sc">+</span></span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>type, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>)</span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>example_3_with_label</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig6-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6: 2D embedding by t-SNE, UMAP, PHATE, PaCMAP, and TriMAP</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>So far, you have an idea that the default value of the neighborhood parameter is only sometimes produced better visualization.</p>
</section>
<section id="is-it-possible-to-find-an-effective-value-for-the-neighborhood-parameter" class="level2">
<h2 class="anchored" data-anchor-id="is-it-possible-to-find-an-effective-value-for-the-neighborhood-parameter">Is it possible to find an effective value for the neighborhood parameter?</h2>
<p><a href="https://lvdmaaten.github.io/tsne/">Laurens van der Maaten</a> suggested that perplexity values in the range (5 - 50) are appropriate for larger / denser data sets. Let’s see the outputs for the simple and complex example defined earlier with different perplexity values.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tSNE_by_perplexity <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tSNE_by_perplexity) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"embedding_1"</span>, <span class="st">"embedding_2"</span>, <span class="st">"perplexity"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>tSNE_by_perplexity<span class="sc">$</span>perplexity <span class="ot">&lt;-</span> <span class="fu">as.character</span>(tSNE_by_perplexity<span class="sc">$</span>perplexity)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the loop.vector </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>loop.vector2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">65</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loop.vector2)) { <span class="co"># Loop over loop.vector</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  perplexity <span class="ot">&lt;-</span> loop.vector2[i]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(random_num2)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  tSNE_fit <span class="ot">&lt;-</span> data_pca <span class="sc">%&gt;%</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Rtsne</span>(<span class="at">perplexity =</span> perplexity)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  tSNE_df <span class="ot">&lt;-</span> tSNE_fit<span class="sc">$</span>Y <span class="sc">%&gt;%</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(tSNE_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'embedding_1'</span>, <span class="st">'embedding_2'</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  tSNE_df<span class="sc">$</span>perplexity <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">"Perplexity: "</span>,perplexity),<span class="fu">nrow</span>(data_pca))</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  tSNE_by_perplexity <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tSNE_by_perplexity,tSNE_df)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity <span class="ot">&lt;-</span> tSNE_by_perplexity <span class="sc">%&gt;%</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> embedding_2, <span class="at">color =</span> <span class="fu">rep</span>(df_2<span class="sc">$</span>class, <span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#1f78b4"</span>, <span class="st">"#e31a1c"</span>)) <span class="sc">+</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Class"</span>)) <span class="sc">+</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>perplexity, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>) </span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig7-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;7: 2D embedding of t-SNE by perplexity.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The two clusters are shown within the range of (5-50) but with different shapes (see <a href="#fig-fig7">Figure&nbsp;7</a>). Outside that range, things get weird when the perplexity value is less than 5. With perplexity 2, local variations dominate.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tSNE_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tSNE_by_perplexity1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"embedding_1"</span>, <span class="st">"embedding_2"</span>, <span class="st">"perplexity"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>tSNE_by_perplexity1<span class="sc">$</span>perplexity <span class="ot">&lt;-</span> <span class="fu">as.character</span>(tSNE_by_perplexity1<span class="sc">$</span>perplexity)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the loop.vector </span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>loop.vector2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loop.vector2)) { <span class="co"># Loop over loop.vector</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  perplexity <span class="ot">&lt;-</span> loop.vector2[i]</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(random_num2)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  tSNE_fit <span class="ot">&lt;-</span> data_pca_n <span class="sc">%&gt;%</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Rtsne</span>(<span class="at">perplexity =</span> perplexity)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  tSNE_df <span class="ot">&lt;-</span> tSNE_fit<span class="sc">$</span>Y <span class="sc">%&gt;%</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(tSNE_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'embedding_1'</span>, <span class="st">'embedding_2'</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  tSNE_df<span class="sc">$</span>perplexity <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">"Perplexity: "</span>,perplexity),<span class="fu">nrow</span>(data_pca_n))</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  tSNE_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tSNE_by_perplexity1,tSNE_df)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>tSNE_by_perplexity1<span class="sc">$</span>perplexity_f <span class="ot">=</span> <span class="fu">factor</span>(tSNE_by_perplexity1<span class="sc">$</span>perplexity, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">'Perplexity: 2'</span>, <span class="st">'Perplexity: 5'</span>, <span class="st">'Perplexity: 30'</span>, <span class="st">'Perplexity: 50'</span>, <span class="st">'Perplexity: 100'</span>, <span class="st">'Perplexity: 150'</span>))</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1 <span class="ot">&lt;-</span> tSNE_by_perplexity1 <span class="sc">%&gt;%</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> embedding_2, <span class="at">color =</span> <span class="fu">rep</span>(df_2_n<span class="sc">$</span>class, <span class="dv">6</span>))) <span class="sc">+</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#1f78b4"</span>, <span class="st">"#e31a1c"</span>, <span class="st">"#33a02c"</span>, <span class="st">"#ff7f00"</span>, <span class="st">"#6a3d9a"</span>)) <span class="sc">+</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Class"</span>)) <span class="sc">+</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>perplexity_f, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>) </span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig8" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig8-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;8: 2D embedding of t-SNE by perplexity.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The local structure dominates when the perplexity is 2 (see <a href="#fig-fig8">Figure&nbsp;8</a>). On the other hand, even though the perplexity is greater than 100, the five clusters are well-separated. Therefore, the range of perplexity defined by the author can be useful for getting an initial value; an effective value for the perplexity can vary according to the data set.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tSNE_by_perplexity2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tSNE_by_perplexity2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"embedding_1"</span>, <span class="st">"embedding_2"</span>, <span class="st">"perplexity"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>tSNE_by_perplexity2<span class="sc">$</span>perplexity <span class="ot">&lt;-</span> <span class="fu">as.character</span>(tSNE_by_perplexity2<span class="sc">$</span>perplexity)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the loop.vector </span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>loop.vector2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loop.vector2)) { <span class="co"># Loop over loop.vector</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  perplexity <span class="ot">&lt;-</span> loop.vector2[i]</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(random_num2)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  tSNE_fit <span class="ot">&lt;-</span> df_2_n1 <span class="sc">%&gt;%</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Rtsne</span>(<span class="at">perplexity =</span> perplexity)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  tSNE_df <span class="ot">&lt;-</span> tSNE_fit<span class="sc">$</span>Y <span class="sc">%&gt;%</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(tSNE_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'embedding_1'</span>, <span class="st">'embedding_2'</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  tSNE_df<span class="sc">$</span>perplexity <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">"Perplexity: "</span>,perplexity),<span class="fu">nrow</span>(df_2_n1))</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  tSNE_by_perplexity2 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tSNE_by_perplexity2,tSNE_df)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>tSNE_by_perplexity2<span class="sc">$</span>perplexity_f <span class="ot">=</span> <span class="fu">factor</span>(tSNE_by_perplexity2<span class="sc">$</span>perplexity, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">'Perplexity: 2'</span>, <span class="st">'Perplexity: 5'</span>, <span class="st">'Perplexity: 30'</span>, <span class="st">'Perplexity: 50'</span>, <span class="st">'Perplexity: 100'</span>, <span class="st">'Perplexity: 150'</span>))</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity2 <span class="ot">&lt;-</span> tSNE_by_perplexity2 <span class="sc">%&gt;%</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> embedding_2)) <span class="sc">+</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>perplexity_f, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>) </span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig9" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig9-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;9: 2D embedding of t-SNE by perplexity.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>You can see in <a href="#fig-fig9">Figure&nbsp;9</a>, except when the perplexity is 30, the shape is not preserved in low-dimensional space.</p>
<p><strong>Note: For the t-SNE algorithm to operate properly, the perplexity really should be smaller than the number of points.</strong></p>
<section id="effective-value-for-perplexity-neighborhood-parameter-of-t-sne" class="level3">
<h3 class="anchored" data-anchor-id="effective-value-for-perplexity-neighborhood-parameter-of-t-sne">Effective value for perplexity (neighborhood parameter of t-SNE)</h3>
<p>According to <a href="https://towardsdatascience.com/how-to-tune-hyperparameters-of-tsne-7c0596a18868#:~:text=The%20optimal%20perplexity%20can%20be%20calculated%20from%20the%20number%20of,data%20points%20of%20~100%20units.">Nikolay Oskolkov</a>, the <span class="math inline">\(\text{Perplexity} ∼ N^{(1/2)}\)</span> where <span class="math inline">\(N\)</span> is the number of observations.</p>
<p><span class="math display">\[
\begin{equation}
    \text{Perplexity} = k * N^{(1/2)}.
   \label{eq:eq3}
  \end{equation}
\]</span></p>
<p>In the simplest scenario, we take <span class="math inline">\(k = 1\)</span>. The effective values for the example data sets is shown below.</p>
<table class="table">
<caption><strong>Table 2: Effective perplexity value for example data sets</strong></caption>
<colgroup>
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Data set</th>
<th>Effective perplexity value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Two clusters in a 2D plane</td>
<td><pre><code>14.14214</code></pre></td>
</tr>
<tr class="even">
<td>Five clusters in 4D</td>
<td><pre><code>22.36068</code></pre></td>
</tr>
<tr class="odd">
<td>2D curvillinear in 4D</td>
<td><pre><code>22.36068</code></pre></td>
</tr>
</tbody>
</table>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="fu">dim</span>(data_pca)[<span class="dv">1</span>]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>opt_perplexity1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(N1)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="fu">dim</span>(data_pca_n)[<span class="dv">1</span>]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>opt_perplexity2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(N2)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>N3 <span class="ot">&lt;-</span> <span class="fu">dim</span>(df_2_n1)[<span class="dv">1</span>]</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>opt_perplexity3 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(N3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s visualize and see whether these values are actually effective.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(random_num2)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>tSNE_fit <span class="ot">&lt;-</span> data_pca <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Rtsne</span>(<span class="at">perplexity =</span> opt_perplexity1)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>tSNE_df <span class="ot">&lt;-</span> tSNE_fit<span class="sc">$</span>Y <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tSNE_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'embedding_1'</span>, <span class="st">'embedding_2'</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_effect_perplexity <span class="ot">&lt;-</span> tSNE_df <span class="sc">%&gt;%</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> embedding_2, <span class="at">color =</span> df_2<span class="sc">$</span>class)) <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#1f78b4"</span>, <span class="st">"#e31a1c"</span>)) <span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Class"</span>)) <span class="sc">+</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>) </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_effect_perplexity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig10" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig10-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;10: 2D embedding of t-SNE for the effetive perplexity value.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(random_num2)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>tSNE_fit <span class="ot">&lt;-</span> data_pca_n <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Rtsne</span>(<span class="at">perplexity =</span> opt_perplexity2)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>tSNE_df <span class="ot">&lt;-</span> tSNE_fit<span class="sc">$</span>Y <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tSNE_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'embedding_1'</span>, <span class="st">'embedding_2'</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_effect_perplexity1 <span class="ot">&lt;-</span> tSNE_df <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> embedding_2, <span class="at">color =</span> df_2_n<span class="sc">$</span>class)) <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#1f78b4"</span>, <span class="st">"#e31a1c"</span>, <span class="st">"#33a02c"</span>, <span class="st">"#ff7f00"</span>, <span class="st">"#6a3d9a"</span>)) <span class="sc">+</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Class"</span>)) <span class="sc">+</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>) </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_effect_perplexity1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig11" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig11-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;11: 2D embedding of t-SNE for the effetive perplexity value.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(random_num2)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>tSNE_fit <span class="ot">&lt;-</span> df_2_n1 <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Rtsne</span>(<span class="at">perplexity =</span> opt_perplexity3)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>tSNE_df <span class="ot">&lt;-</span> tSNE_fit<span class="sc">$</span>Y <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tSNE_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'embedding_1'</span>, <span class="st">'embedding_2'</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_effect_perplexity2 <span class="ot">&lt;-</span> tSNE_df <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> embedding_2)) <span class="sc">+</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>) </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_effect_perplexity2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig12" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig12-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;12: 2D embedding of t-SNE for the effetive perplexity value.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Regarding <a href="#fig-fig10">Figure&nbsp;10</a>, <a href="#fig-fig11">Figure&nbsp;11</a>, and <a href="#fig-fig12">Figure&nbsp;12</a>, you can see that these values are not the best, but to begin the analysis, we can use these as initial values.</p>
<p>The authors do not officially define a method of finding an effective value for the neighborhood parameter in other NLDR techniques. Therefore, we have to visualize and see the best value to consider.</p>
<p>Let’s compare the outputs of other NLDR techniques.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>UMAP_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(UMAP_by_perplexity1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"embedding_1"</span>, <span class="st">"embedding_2"</span>, <span class="st">"n_neighbors"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>UMAP_by_perplexity1<span class="sc">$</span>n_neighbors <span class="ot">&lt;-</span> <span class="fu">as.character</span>(UMAP_by_perplexity1<span class="sc">$</span>n_neighbors)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the loop.vector </span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>loop.vector2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loop.vector2)) { <span class="co"># Loop over loop.vector</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  n_neighbors <span class="ot">&lt;-</span> loop.vector2[i]</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(random_num2)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  UMAP_fit <span class="ot">&lt;-</span> data_pca_n <span class="sc">%&gt;%</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">umap</span>(<span class="at">n_neighbors =</span> n_neighbors)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  UMAP_df <span class="ot">&lt;-</span> UMAP_fit<span class="sc">$</span>layout <span class="sc">%&gt;%</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(UMAP_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'embedding_1'</span>, <span class="st">'embedding_2'</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  UMAP_df<span class="sc">$</span>n_neighbors <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">"n_neighbors: "</span>, n_neighbors),<span class="fu">nrow</span>(data_pca_n))</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  UMAP_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(UMAP_by_perplexity1,UMAP_df)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>UMAP_by_perplexity1<span class="sc">$</span>n_neighbors_f <span class="ot">=</span> <span class="fu">factor</span>(UMAP_by_perplexity1<span class="sc">$</span>n_neighbors, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">'n_neighbors: 2'</span>, <span class="st">'n_neighbors: 5'</span>, <span class="st">'n_neighbors: 15'</span>, <span class="st">'n_neighbors: 30'</span>, <span class="st">'n_neighbors: 50'</span>, <span class="st">'n_neighbors: 100'</span>))</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1 <span class="ot">&lt;-</span> UMAP_by_perplexity1 <span class="sc">%&gt;%</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> embedding_2, <span class="at">color =</span> <span class="fu">rep</span>(df_2_n<span class="sc">$</span>class, <span class="dv">6</span>))) <span class="sc">+</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#1f78b4"</span>, <span class="st">"#e31a1c"</span>, <span class="st">"#33a02c"</span>, <span class="st">"#ff7f00"</span>, <span class="st">"#6a3d9a"</span>)) <span class="sc">+</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Class"</span>)) <span class="sc">+</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>n_neighbors_f, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>) </span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig13" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig13-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;13: 2D embedding of UMAP by n_neighbors.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The five clusters are nicely separated except when the number of neighbors is 2 in UMAP (see <a href="#fig-fig13">Figure&nbsp;13</a>). In n-neighbors: 2, the original clusters are divided into small clusters, representing a misleading result. Also, the distance between clusters (change global structure) and the shapes of the clusters vary as the value of n_neighbors increases.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>UMAP_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(UMAP_by_perplexity1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"embedding_1"</span>, <span class="st">"embedding_2"</span>, <span class="st">"n_neighbors"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>UMAP_by_perplexity1<span class="sc">$</span>n_neighbors <span class="ot">&lt;-</span> <span class="fu">as.character</span>(UMAP_by_perplexity1<span class="sc">$</span>n_neighbors)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the loop.vector </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>loop.vector2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loop.vector2)) { <span class="co"># Loop over loop.vector</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  n_neighbors <span class="ot">&lt;-</span> loop.vector2[i]</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(random_num2)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  UMAP_fit <span class="ot">&lt;-</span> df_2_n1 <span class="sc">%&gt;%</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">umap</span>(<span class="at">n_neighbors =</span> n_neighbors)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  UMAP_df <span class="ot">&lt;-</span> UMAP_fit<span class="sc">$</span>layout <span class="sc">%&gt;%</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(UMAP_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'embedding_1'</span>, <span class="st">'embedding_2'</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  UMAP_df<span class="sc">$</span>n_neighbors <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">"n_neighbors: "</span>, n_neighbors),<span class="fu">nrow</span>(df_2_n1))</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  UMAP_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(UMAP_by_perplexity1,UMAP_df)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>UMAP_by_perplexity1<span class="sc">$</span>n_neighbors_f <span class="ot">=</span> <span class="fu">factor</span>(UMAP_by_perplexity1<span class="sc">$</span>n_neighbors, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">'n_neighbors: 2'</span>, <span class="st">'n_neighbors: 5'</span>, <span class="st">'n_neighbors: 15'</span>, <span class="st">'n_neighbors: 30'</span>, <span class="st">'n_neighbors: 50'</span>, <span class="st">'n_neighbors: 100'</span>))</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1 <span class="ot">&lt;-</span> UMAP_by_perplexity1 <span class="sc">%&gt;%</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> embedding_2)) <span class="sc">+</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>n_neighbors_f, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>) </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig14" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig14-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;14: 2D embedding of UMAP by n_neighbors.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>As shown in <a href="#fig-fig15">Figure&nbsp;15</a>, in TriMAP, the local structure dominates when the number of neighbors is 2 and 100. There are some sub-clusters of main clusters.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>TriMAP_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(TriMAP_by_perplexity1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"embedding_1"</span>, <span class="st">"embedding_2"</span>, <span class="st">"n_neighbors"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>TriMAP_by_perplexity1<span class="sc">$</span>n_neighbors <span class="ot">&lt;-</span> <span class="fu">as.character</span>(TriMAP_by_perplexity1<span class="sc">$</span>n_neighbors)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the loop.vector </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>loop.vector2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loop.vector2)) { <span class="co"># Loop over loop.vector</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  n_inliers_n <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(loop.vector2[i])</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(random_num2)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">source</span>(<span class="st">"functions_tri_hex_TriMAP_without_pc.R"</span>, <span class="at">local =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">source_python</span>(<span class="st">"Fit_TriMAP_code.py"</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#n_inliers_n &lt;- as.integer(12)</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  n_outliers_n <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="dv">4</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  n_random_n <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="dv">3</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  tem_dir <span class="ot">&lt;-</span> <span class="fu">tempdir</span>()</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Fit_TriMAP_data</span>(data_pca_n, tem_dir)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(tem_dir, <span class="st">"df_2_without_class.csv"</span>)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  path2 <span class="ot">&lt;-</span> <span class="fu">file.path</span>(tem_dir, <span class="st">"dataset_3_TriMAP_values.csv"</span>)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(random_num2)</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Fit_TriMAP</span>(<span class="fu">as.integer</span>(<span class="dv">2</span>), n_inliers_n, n_outliers_n, n_random_n, path, path2)</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  TriMAP_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(path2)</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(TriMAP_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'embedding_1'</span>, <span class="st">'embedding_2'</span>)</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  TriMAP_df<span class="sc">$</span>n_inliers <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">"n_inliers: "</span>, n_inliers_n),<span class="fu">nrow</span>(data_pca_n))</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  TriMAP_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TriMAP_by_perplexity1,TriMAP_df)</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>TriMAP_by_perplexity1<span class="sc">$</span>n_inliers_f <span class="ot">=</span> <span class="fu">factor</span>(TriMAP_by_perplexity1<span class="sc">$</span>n_inliers, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">'n_inliers: 2'</span>, <span class="st">'n_inliers: 5'</span>, <span class="st">'n_inliers: 12'</span>, <span class="st">'n_inliers: 30'</span>, <span class="st">'n_inliers: 50'</span>, <span class="st">'n_inliers: 100'</span>))</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1 <span class="ot">&lt;-</span> TriMAP_by_perplexity1 <span class="sc">%&gt;%</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> embedding_2, <span class="at">color =</span> <span class="fu">rep</span>(df_2_n<span class="sc">$</span>class, <span class="dv">6</span>))) <span class="sc">+</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#1f78b4"</span>, <span class="st">"#e31a1c"</span>, <span class="st">"#33a02c"</span>, <span class="st">"#ff7f00"</span>, <span class="st">"#6a3d9a"</span>)) <span class="sc">+</span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Class"</span>)) <span class="sc">+</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>n_inliers_f, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>) </span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig15" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig15-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;15: 2D embedding of TriMAP by knn.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In TriMAP, 2D curvilinear changes from a cheese slice to an umbrella (see <a href="#fig-fig16">Figure&nbsp;16</a>). The local structure is not preserved as expected.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>TriMAP_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(TriMAP_by_perplexity1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"embedding_1"</span>, <span class="st">"embedding_2"</span>, <span class="st">"n_neighbors"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>TriMAP_by_perplexity1<span class="sc">$</span>n_neighbors <span class="ot">&lt;-</span> <span class="fu">as.character</span>(TriMAP_by_perplexity1<span class="sc">$</span>n_neighbors)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the loop.vector </span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>loop.vector2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loop.vector2)) { <span class="co"># Loop over loop.vector</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  n_inliers_n <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(loop.vector2[i])</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(random_num2)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">source</span>(<span class="st">"functions_tri_hex_TriMAP_without_pc.R"</span>, <span class="at">local =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">source_python</span>(<span class="st">"Fit_TriMAP_code.py"</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#n_inliers_n &lt;- as.integer(12)</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  n_outliers_n <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="dv">4</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  n_random_n <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="dv">3</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  tem_dir <span class="ot">&lt;-</span> <span class="fu">tempdir</span>()</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Fit_TriMAP_data</span>(df_2_n1, tem_dir)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(tem_dir, <span class="st">"df_2_without_class.csv"</span>)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  path2 <span class="ot">&lt;-</span> <span class="fu">file.path</span>(tem_dir, <span class="st">"dataset_3_TriMAP_values.csv"</span>)</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(random_num2)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Fit_TriMAP</span>(<span class="fu">as.integer</span>(<span class="dv">2</span>), n_inliers_n, n_outliers_n, n_random_n, path, path2)</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  TriMAP_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(path2)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(TriMAP_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'embedding_1'</span>, <span class="st">'embedding_2'</span>)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>  TriMAP_df<span class="sc">$</span>n_inliers <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">"n_inliers: "</span>, n_inliers_n),<span class="fu">nrow</span>(df_2_n1))</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>  TriMAP_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TriMAP_by_perplexity1,TriMAP_df)</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>TriMAP_by_perplexity1<span class="sc">$</span>n_inliers_f <span class="ot">=</span> <span class="fu">factor</span>(TriMAP_by_perplexity1<span class="sc">$</span>n_inliers, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">'n_inliers: 2'</span>, <span class="st">'n_inliers: 5'</span>, <span class="st">'n_inliers: 12'</span>, <span class="st">'n_inliers: 30'</span>, <span class="st">'n_inliers: 50'</span>, <span class="st">'n_inliers: 100'</span>))</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1 <span class="ot">&lt;-</span> TriMAP_by_perplexity1 <span class="sc">%&gt;%</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> embedding_2)) <span class="sc">+</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>n_inliers_f, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>) </span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig16" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig16-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;16: 2D embedding of TriMAP by knn.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In PaCMAP, with knn: 2, local variations dominate, dividing each cluster into small clusters (see <a href="#fig-fig17">Figure&nbsp;17</a>). However, when the knn value is greater than 5, the five clusters preserve the global structure, while the shape of the clusters changes a bit.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>PaCMAP_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(PaCMAP_by_perplexity1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"embedding_1"</span>, <span class="st">"embedding_2"</span>, <span class="st">"n_neighbors"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>PaCMAP_by_perplexity1<span class="sc">$</span>knn <span class="ot">&lt;-</span> <span class="fu">as.character</span>(PaCMAP_by_perplexity1<span class="sc">$</span>knn)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the loop.vector </span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>loop.vector2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loop.vector2)) { <span class="co"># Loop over loop.vector</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  knn_n <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(loop.vector2[i])</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(random_num2)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">source</span>(<span class="st">"functions_tri_hex_PaCMAP_without_pc.R"</span>, <span class="at">local =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">source_python</span>(<span class="st">"Fit_PacMAP_code.py"</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  init_n <span class="ot">&lt;-</span> <span class="st">"random"</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  MN_ratio_n <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  FP_ratio_n <span class="ot">&lt;-</span> <span class="fl">2.0</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  tem_dir <span class="ot">&lt;-</span> <span class="fu">tempdir</span>()</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Fit_PacMAP_data</span>(data_pca_n, tem_dir)</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(random_num2)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(tem_dir, <span class="st">"df_2_without_class.csv"</span>)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  path2 <span class="ot">&lt;-</span> <span class="fu">file.path</span>(tem_dir, <span class="st">"dataset_3_PaCMAP_values.csv"</span>)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Fit_PaCMAP</span>(<span class="fu">as.integer</span>(<span class="dv">2</span>), knn_n, init_n, MN_ratio_n, FP_ratio_n, path, path2)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  PaCMAP_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(path2)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(PaCMAP_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'embedding_1'</span>, <span class="st">'embedding_2'</span>)</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  PaCMAP_df<span class="sc">$</span>knn <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">"knn: "</span>, knn_n),<span class="fu">nrow</span>(data_pca_n))</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>  PaCMAP_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(PaCMAP_by_perplexity1,PaCMAP_df)</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>PaCMAP_by_perplexity1<span class="sc">$</span>knn_f <span class="ot">=</span> <span class="fu">factor</span>(PaCMAP_by_perplexity1<span class="sc">$</span>knn, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">'knn: 2'</span>, <span class="st">'knn: 5'</span>, <span class="st">'knn: 10'</span>, <span class="st">'knn: 30'</span>, <span class="st">'knn: 50'</span>, <span class="st">'knn: 100'</span>))</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1 <span class="ot">&lt;-</span> PaCMAP_by_perplexity1 <span class="sc">%&gt;%</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> embedding_2, <span class="at">color =</span> <span class="fu">rep</span>(df_2_n<span class="sc">$</span>class, <span class="dv">6</span>))) <span class="sc">+</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#1f78b4"</span>, <span class="st">"#e31a1c"</span>, <span class="st">"#33a02c"</span>, <span class="st">"#ff7f00"</span>, <span class="st">"#6a3d9a"</span>)) <span class="sc">+</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Class"</span>)) <span class="sc">+</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>knn_f, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>) </span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig17" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig17-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;17: 2D embedding of PaCMAP by n_neighbors.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Another surprise…when knn is 2, the 2D curvilinear looks like a tree branch (see <a href="#fig-fig18">Figure&nbsp;18</a>). Also, as the knn value increases, the 2D curvilinear becomes more clumpy, misleading the structure.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>PaCMAP_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(PaCMAP_by_perplexity1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"embedding_1"</span>, <span class="st">"embedding_2"</span>, <span class="st">"n_neighbors"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>PaCMAP_by_perplexity1<span class="sc">$</span>knn <span class="ot">&lt;-</span> <span class="fu">as.character</span>(PaCMAP_by_perplexity1<span class="sc">$</span>knn)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the loop.vector </span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>loop.vector2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loop.vector2)) { <span class="co"># Loop over loop.vector</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  knn_n <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(loop.vector2[i])</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(random_num2)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">source</span>(<span class="st">"functions_tri_hex_PaCMAP_without_pc.R"</span>, <span class="at">local =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">source_python</span>(<span class="st">"Fit_PacMAP_code.py"</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  init_n <span class="ot">&lt;-</span> <span class="st">"random"</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  MN_ratio_n <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  FP_ratio_n <span class="ot">&lt;-</span> <span class="fl">2.0</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  tem_dir <span class="ot">&lt;-</span> <span class="fu">tempdir</span>()</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Fit_PacMAP_data</span>(df_2_n1, tem_dir)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(random_num2)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(tem_dir, <span class="st">"df_2_without_class.csv"</span>)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  path2 <span class="ot">&lt;-</span> <span class="fu">file.path</span>(tem_dir, <span class="st">"dataset_3_PaCMAP_values.csv"</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Fit_PaCMAP</span>(<span class="fu">as.integer</span>(<span class="dv">2</span>), knn_n, init_n, MN_ratio_n, FP_ratio_n, path, path2)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>  PaCMAP_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(path2)</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(PaCMAP_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'embedding_1'</span>, <span class="st">'embedding_2'</span>)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>  PaCMAP_df<span class="sc">$</span>knn <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">"knn: "</span>, knn_n),<span class="fu">nrow</span>(df_2_n1))</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>  PaCMAP_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(PaCMAP_by_perplexity1,PaCMAP_df)</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>PaCMAP_by_perplexity1<span class="sc">$</span>knn_f <span class="ot">=</span> <span class="fu">factor</span>(PaCMAP_by_perplexity1<span class="sc">$</span>knn, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">'knn: 2'</span>, <span class="st">'knn: 5'</span>, <span class="st">'knn: 10'</span>, <span class="st">'knn: 30'</span>, <span class="st">'knn: 50'</span>, <span class="st">'knn: 100'</span>))</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1 <span class="ot">&lt;-</span> PaCMAP_by_perplexity1 <span class="sc">%&gt;%</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> embedding_2)) <span class="sc">+</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>knn_f, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>) </span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig18" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig18-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;18: 2D embedding of PaCMAP by n_neighbors.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>As seen in <a href="#fig-fig19">Figure&nbsp;19</a>, and <a href="#fig-fig20">Figure&nbsp;20</a>, we have a surprising result. After the default neighborhood value (5) of PHATE, the visualizations are the same as the default neighborhood value.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>PHATE_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(PHATE_by_perplexity1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"embedding_1"</span>, <span class="st">"embedding_2"</span>, <span class="st">"n_neighbors"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>PHATE_by_perplexity1<span class="sc">$</span>knn <span class="ot">&lt;-</span> <span class="fu">as.character</span>(PHATE_by_perplexity1<span class="sc">$</span>knn)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the loop.vector </span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>loop.vector2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loop.vector2)) { <span class="co"># Loop over loop.vector</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  knn_n <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(loop.vector2[i])</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(random_num2)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  tree_phate_fit <span class="ot">&lt;-</span> <span class="fu">phate</span>(data_pca_n, knn_n)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  PHATE_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tree_phate_fit<span class="sc">$</span>embedding)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  PHATE_df <span class="ot">&lt;-</span> PHATE_df <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">"PHATE1"</span>, <span class="st">"PHATE2"</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(PHATE_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'embedding_1'</span>, <span class="st">'embedding_2'</span>)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#PHATE_df$type &lt;- rep("PHATE", nrow(df_2_n1))</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(PHATE_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'embedding_1'</span>, <span class="st">'embedding_2'</span>)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  PHATE_df<span class="sc">$</span>knn <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">"knn: "</span>, knn_n),<span class="fu">nrow</span>(data_pca_n))</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  PHATE_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(PHATE_by_perplexity1,PHATE_df)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>PHATE_by_perplexity1<span class="sc">$</span>knn_f <span class="ot">=</span> <span class="fu">factor</span>(PHATE_by_perplexity1<span class="sc">$</span>knn, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">'knn: 2'</span>, <span class="st">'knn: 5'</span>, <span class="st">'knn: 10'</span>, <span class="st">'knn: 30'</span>, <span class="st">'knn: 50'</span>, <span class="st">'knn: 100'</span>))</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1 <span class="ot">&lt;-</span> PHATE_by_perplexity1 <span class="sc">%&gt;%</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> embedding_2, <span class="at">color =</span> <span class="fu">rep</span>(df_2_n<span class="sc">$</span>class, <span class="dv">6</span>))) <span class="sc">+</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#1f78b4"</span>, <span class="st">"#e31a1c"</span>, <span class="st">"#33a02c"</span>, <span class="st">"#ff7f00"</span>, <span class="st">"#6a3d9a"</span>)) <span class="sc">+</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Class"</span>)) <span class="sc">+</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>knn_f, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>) </span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig19" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig19-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;19: 2D embedding of PHATE by knn.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>PHATE_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(PHATE_by_perplexity1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"embedding_1"</span>, <span class="st">"embedding_2"</span>, <span class="st">"n_neighbors"</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>PHATE_by_perplexity1<span class="sc">$</span>knn <span class="ot">&lt;-</span> <span class="fu">as.character</span>(PHATE_by_perplexity1<span class="sc">$</span>knn)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the loop.vector </span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>loop.vector2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(loop.vector2)) {  <span class="co"># Loop over loop.vector</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  knn_n <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(loop.vector2[i])</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  random_num2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10000000</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(random_num2)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  tree_phate_fit <span class="ot">&lt;-</span> <span class="fu">phate</span>(df_2_n1, knn_n)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  PHATE_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tree_phate_fit<span class="sc">$</span>embedding)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  PHATE_df <span class="ot">&lt;-</span> PHATE_df <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">"PHATE1"</span>, <span class="st">"PHATE2"</span>)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(PHATE_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'embedding_1'</span>, <span class="st">'embedding_2'</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#PHATE_df$type &lt;- rep("PHATE", nrow(df_2_n1))</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(PHATE_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'embedding_1'</span>, <span class="st">'embedding_2'</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  PHATE_df<span class="sc">$</span>knn <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">"knn: "</span>, knn_n),<span class="fu">nrow</span>(df_2_n1))</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  PHATE_by_perplexity1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(PHATE_by_perplexity1,PHATE_df)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>PHATE_by_perplexity1<span class="sc">$</span>knn_f <span class="ot">=</span> <span class="fu">factor</span>(PHATE_by_perplexity1<span class="sc">$</span>knn, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">'knn: 2'</span>, <span class="st">'knn: 5'</span>, <span class="st">'knn: 10'</span>, <span class="st">'knn: 30'</span>, <span class="st">'knn: 50'</span>, <span class="st">'knn: 100'</span>))</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1 <span class="ot">&lt;-</span> PHATE_by_perplexity1 <span class="sc">%&gt;%</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> embedding_1,</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> embedding_2)) <span class="sc">+</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>knn_f, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"embedding 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"embedding 2"</span>) </span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>plot_tSNE_by_perplexity1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig20" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fig20-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;20: 2D embedding of PHATE by knn.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The effective value of the neighborhood parameter depends on the data set. Therefore, we must choose the most effective one by evaluating the outputs for different neighborhood parameter values.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>